/**
 * JavaScript for FastCGI Cache Purge and Preload for Nginx
 * Description: This minified version of JavaScript file contains functions to manage FastCGI Cache Purge and Preload for Nginx plugin and interact with WordPress admin dashboard.
 * Version: 2.0.4
 * Author: Hasan ÇALIŞIR
 * Author Email: hasan.calisir@psauxit.com
 * Author URI: https://www.psauxit.com
 * License: GPL-2.0+
 */

!function(e,t,n,o){"use strict";e(n).ready((function(){function o(){t.innerWidth<480&&e(".status-summary table tbody tr").each((function(){const t=e(this).find(".action .action-wrapper:last-of-type"),n=e(this).find("#npppphpFpmStatus");if(t.length&&n.length){const o=e('<div class="status-wrapper"></div>');o.css({"font-size":"14px",color:"green","margin-top":"5px"}).html(n.html()),n.hide(),t.after(o)}const o=e(this).find(".action .action-wrapper");if(o.length>1){const t=o.eq(1);if("12px"===t.css("font-size")){const n=e("<span></span>").css({"font-size":"10px",color:t.css("color")}).text(t.text().trim());t.empty().append(n)}}}))}e(t).on("resize",o),o();const s=e("#nppp-loader-overlay"),a=e("#settings-content-placeholder"),p=e("#status-content-placeholder"),c=e("#premium-content-placeholder");function i(){e(".nppp-loader-fill").css({animation:"nppp-fill 2s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"none","-webkit-backdrop-filter":"none",transition:"none"}),s.addClass("active").fadeIn(50)}function r(){s.removeClass("active").fadeOut(50),e(".nppp-loader-fill").css({animation:"nppp-fill 5s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"blur(1px)","-webkit-backdrop-filter":"blur(1px)",transition:"opacity 0.3s ease, visibility 0.3s ease"})}function l(){e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_cache_status",_wpnonce:nppp_admin_data.cache_status_nonce},success:function(o){""!==o.trim()?(p.html(o).css("opacity",0).show(),function(){n.querySelector("#npppphpFpmStatus").closest("tr");var e=n.getElementById("npppphpFpmStatus"),t=e.textContent.trim();e.textContent=t,e.style.fontSize="14px","false"===t?(e.style.color="red",e.innerHTML='<span class="dashicons dashicons-no"></span> Required (Check Help)'):"Not Found"===t?(e.style.color="orange",e.innerHTML='<span class="dashicons dashicons-clock"></span> Not Determined'):(e.style.color="green",e.innerHTML='<span class="dashicons dashicons-yes"></span> Not Required');var o=n.getElementById("npppphpPagesInCache"),s=o.textContent.trim();o.style.fontSize="14px","Undetermined"===s?(o.style.color="red",o.innerHTML='<span class="dashicons dashicons-no"></span> Permission Issue'):"0"===s?(o.style.color="orange",o.innerHTML='<span class="dashicons dashicons-clock"></span> '+s):"Not Found"===s?(o.style.color="orange",o.innerHTML='<span class="dashicons dashicons-clock"></span> Not Determined'):(o.style.color="green",o.innerHTML='<span class="dashicons dashicons-yes"></span> '+s);var a=n.getElementById("npppphpProcessOwner"),p=a.textContent.trim();a.textContent=p,a.style.fontSize="14px",a.style.color="green",a.innerHTML='<span class="dashicons dashicons-arrow-right-alt" style="font-size: 16px;"></span> '+p;var c=n.getElementById("npppphpWebServer"),i=c.textContent.trim();c.textContent=i,c.style.fontSize="14px",c.style.color="green",c.innerHTML='<span class="dashicons dashicons-arrow-right-alt" style="font-size: 16px;"></span> '+i;var r=n.getElementById("npppcachePath"),l=r.textContent.trim();r.textContent=l,r.style.fontSize="14px","Found"===l?(r.style.color="green",r.innerHTML='<span class="dashicons dashicons-yes"></span> Found'):"Not Found"===l&&(r.style.color="red",r.innerHTML='<span class="dashicons dashicons-no"></span> Not Found');var d=n.getElementById("nppppurgeStatus"),u=d.textContent.trim();d.textContent=u,d.style.fontSize="14px","true"===u?(d.style.color="green",d.innerHTML='<span class="dashicons dashicons-yes"></span> Ready'):"false"===u?(d.style.color="red",d.innerHTML='<span class="dashicons dashicons-no"></span> Not Ready'):(d.style.color="orange",d.innerHTML='<span class="dashicons dashicons-clock"></span> Not Determined');var f=n.getElementById("npppshellExec"),h=f.textContent.trim();f.textContent=h,f.style.fontSize="14px","Ok"===h?(f.style.color="green",f.innerHTML='<span class="dashicons dashicons-yes"></span> Allowed'):"Not Ok"===h&&(f.style.color="red",f.innerHTML='<span class="dashicons dashicons-no"></span> Not Allowed');var y=n.getElementById("npppaclStatus"),_=y.textContent.trim();if(y.textContent=_,y.style.fontSize="14px",_.includes("Granted")){y.style.color="green";var g=_.replace("Granted","").trim();y.innerHTML='<span class="dashicons dashicons-yes"></span> Granted '+(g?`<span style="color:darkorange;">${g}</span>`:"")}else _.includes("Need Action")?(y.style.color="red",y.innerHTML='<span class="dashicons dashicons-no"></span> Need Action (Check Help)'):(y.style.color="orange",y.innerHTML='<span class="dashicons dashicons-clock"></span> Not Determined');var m=n.querySelector("#nppppreloadStatus").closest("tr").querySelector("#nppppreloadStatus"),x=n.getElementById("nppppreloadStatus"),v=x.textContent.trim();x.textContent=v,x.style.fontSize="14px","true"===v?(x.style.color="green",x.innerHTML='<span class="dashicons dashicons-yes"></span> Ready'):"false"===v?(x.style.color="red",x.innerHTML='<span class="dashicons dashicons-no"></span> Not Ready'):(x.style.color="orange",x.innerHTML='<span class="dashicons dashicons-clock"></span> In Progress',m.style.backgroundColor="lightgreen",m.animate([{backgroundColor:"inherit"},{backgroundColor:"#90ee90"}],{duration:1e3,iterations:1/0,direction:"alternate"}));var b=n.getElementById("npppwgetStatus"),C=b.textContent.trim();b.textContent=C,b.style.fontSize="14px","Installed"===C?(b.style.color="green",b.innerHTML='<span class="dashicons dashicons-yes"></span> Installed'):"Not Installed"===C&&(b.style.color="red",b.innerHTML='<span class="dashicons dashicons-no"></span> Not Installed');var k=n.getElementById("nppppermIsolation"),w=k.textContent.trim();k.textContent=w,k.style.fontSize="14px","Isolated"===w?(k.style.color="green",k.innerHTML='<span class="dashicons dashicons-yes"></span> '+w):"Not Isolated"===w&&(k.style.color="orange",k.innerHTML='<span class="dashicons dashicons-clock"></span> '+w);var T=n.getElementById("npppcpulimitStatus"),E=T.textContent.trim();T.textContent=E,T.style.fontSize="14px","Installed"===E?(T.style.color="green",T.innerHTML='<span class="dashicons dashicons-yes"></span> Installed'):"Not Installed"===E&&(T.style.color="red",T.innerHTML='<span class="dashicons dashicons-no"></span> Not Installed');n.querySelectorAll(".status").forEach((e=>{e.addEventListener("click",(()=>{e.querySelector(".dashicons").classList.add("spin"),setTimeout((()=>{e.querySelector(".dashicons").classList.remove("spin")}),1e3)}))}))}(),r(),p.animate({opacity:1},100)):(console.error("Empty response received"),r(),p.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                    '),p.show()),e(t).trigger("resize").trigger("scroll")},error:function(e,t,n){console.error(n),r(),p.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                '),p.show()}})}function d(){e("#nppp-premium-table tbody tr").each((function(){var t=e(this).find("td").eq(2);switch(t.text().trim()){case"POST":t.css({color:"fuchsia","font-weight":"bold"});break;case"AUTHOR":t.css({color:"orange","font-weight":"bold"});break;case"PAGE":t.css({color:"green","font-weight":"bold"});break;case"TAG":t.css({color:"blue","font-weight":"bold"});break;case"CATEGORY":t.css({color:"mediumslateblue","font-weight":"bold"});break;case"DAILY_ARCHIVE":t.css({color:"red","font-weight":"bold"});break;case"MONTHLY_ARCHIVE":t.css({color:"brown","font-weight":"bold"});break;case"YEARLY_ARCHIVE":t.css({color:"darkblue","font-weight":"bold"});break;case"DATE_ARCHIVE":t.css({color:"darkmagenta","font-weight":"bold"});break;case"PRODUCT":t.css({color:"coral","font-weight":"bold"});break;default:t.css({color:"burlywood","font-weight":"bold"})}e(this).find("td").eq(3).css({color:"green"})}))}function u(){n.querySelectorAll("#nppp-premium-table > tbody > tr").forEach((function(e){[e.querySelector("td:nth-child(2)"),e.querySelector("td:nth-child(3)"),e.querySelector("td:nth-child(4)"),e.querySelector("td:nth-child(5)")].forEach((function(e){""===e.textContent.trim()&&(e.style.display="none")}))}))}e("#nppp-nginx-tabs").tabs({activate:function(n,s){var f=s.newPanel.attr("id");"help"!==f&&i(),a.hide(),p.hide(),c.hide(),"settings"===f?s.newPanel.hasClass("ui-tabs-active")?r():location.reload():"status"===f?(l(),o()):"premium"===f&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_load_premium_content",_wpnonce:nppp_admin_data.premium_content_nonce},success:function(n){""!==n.trim()?(c.html(n).css("opacity",0).show(),e("#nppp-premium-table").DataTable({autoWidth:!1,responsive:!0,paging:!0,ordering:!0,searching:!0,lengthMenu:[10,25,50,100],pageLength:10,language:{paginate:{first:"First",last:"Last",next:"&#8594;",previous:"&#8592;"},search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)"},columnDefs:[{width:"28%",targets:0,className:"text-left"},{width:"30%",targets:1,className:"text-left"},{width:"10%",targets:2,className:"text-left"},{width:"10%",targets:3,className:"text-left"},{width:"10%",targets:4,className:"text-left"},{width:"12%",targets:5,className:"text-left"},{responsivePriority:1,targets:0},{responsivePriority:1e4,targets:[1,2,3,4,5]},{defaultContent:"",targets:"_all"}],initComplete:function(){d(),u()}}).on("draw",(function(){d(),u()})),e("#nppp-premium-table").DataTable().responsive.recalc(),r(),c.animate({opacity:1},100)):(console.error(status+": "+error),r(),c.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                    '),c.show()),e(t).trigger("resize").trigger("scroll")},error:function(e,t,n){console.error(t+": "+n),r(),c.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                '),c.show()}})},beforeLoad:function(e,t){t.jqXHR.fail((function(){t.panel.html("Couldn't load this tab. We'll try to fix this as soon as possible."),r()}))}}),"#status"===t.location.hash&&(i(),l(),o()),e(n).on("click",".nppp-purge-btn",(function(){var t=e(this),n=t.data("file"),o=t.closest("tr");confirm("Are you sure you want to purge cache?")&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_purge_cache_premium",file_path:n,_wpnonce:nppp_admin_data.premium_nonce_purge},success:function(n){var s;n.success?(alert(n.data),o.hasClass("child")&&(o=o.prev("tr")),s=o.hasClass("dtr-expanded")?o.next(".child").find(".nppp-preload-btn"):o.find(".nppp-preload-btn"),t.prop("disabled",!0),t.addClass("disabled"),s.css("background-color","#43A047"),s.prop("disabled",!1),s.removeClass("disabled"),"rgb(67, 160, 71)"===t.css("background-color")&&t.css("background-color",""),e("tr.purged-row").removeClass("purged-row"),setTimeout((function(){o.addClass("purged-row")}),0)):alert(n.data)},error:function(e,t,n){alert(n)}})})),e(n).on("click",".nppp-preload-btn",(function(){var t=e(this),n=t.data("url"),o=t.closest("tr");confirm("Are you sure you want to preload cache?")&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_preload_cache_premium",cache_url:n,_wpnonce:nppp_admin_data.premium_nonce_preload},success:function(n){var s;n.success?(alert(n.data),o.hasClass("child")&&(o=o.prev("tr")),s=o.hasClass("dtr-expanded")?o.next(".child").find(".nppp-purge-btn"):o.find(".nppp-purge-btn"),t.prop("disabled",!0),t.addClass("disabled"),s.css("background-color","#43A047"),s.prop("disabled",!1),s.removeClass("disabled"),"rgb(67, 160, 71)"===t.css("background-color")&&t.css("background-color",""),e("tr.purged-row").removeClass("purged-row"),setTimeout((function(){o.addClass("purged-row")}),0)):alert(n.data)},error:function(e,t,n){alert(n)}})})),e("#nginx_cache_send_mail").change((function(){var t=jQuery(this).next(".nppp-onoffswitch-label"),o=t.offset(),s=o.left+t.outerWidth()+10,a=o.top,p=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_send_mail_option",send_mail:p,_wpnonce:nppp_admin_data.send_mail_nonce},(function(t){if(t.success){var o=n.createElement("div");o.textContent="Saved",o.style.position="absolute",o.style.left=s+"px",o.style.top=a+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),1e3)}else e("#nginx_cache_send_mail").prop("checked",!e("#nginx_cache_send_mail").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_auto_preload").change((function(){var t=jQuery(this).next(".nppp-onoffswitch-label-preload"),o=t.offset(),s=o.left+t.outerWidth()+10,a=o.top,p=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_preload_option",auto_preload:p,_wpnonce:nppp_admin_data.auto_preload_nonce},(function(t){if(t.success){var o=n.createElement("div");o.textContent="Saved",o.style.position="absolute",o.style.left=s+"px",o.style.top=a+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),1e3)}else e("#nginx_cache_auto_preload").prop("checked",!e("#nginx_cache_auto_preload").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_purge_on_update").change((function(){var t=jQuery(this).next(".nppp-onoffswitch-label-autopurge"),o=t.offset(),s=o.left+t.outerWidth()+10,a=o.top,p=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_purge_option",auto_purge:p,_wpnonce:nppp_admin_data.auto_purge_nonce},(function(t){if(t.success){var o=n.createElement("div");o.textContent="Saved",o.style.position="absolute",o.style.left=s+"px",o.style.top=a+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),1e3)}else e("#nginx_cache_purge_on_update").prop("checked",!e("#nginx_cache_purge_on_update").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_api").change((function(){var t=jQuery(this).next(".nppp-onoffswitch-label-api"),o=t.offset(),s=o.left+t.outerWidth()+10,a=o.top,p=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_api_option",nppp_api:p,_wpnonce:nppp_admin_data.api_nonce},(function(t){if(t.success){var o=n.createElement("div");o.textContent="Saved",o.style.position="absolute",o.style.left=s+"px",o.style.top=a+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),1e3)}else e("#nginx_cache_api").prop("checked",!e("#nginx_cache_api").prop("checked")),alert("Error updating option!")}))})),e("#nginx-cache-schedule-set").on("click",(function(){event.preventDefault();var t=e("#nppp_cron_event").val(),n=e("#nppp_datetimepicker1Input").val();if(!t||"daily"!==t&&"weekly"!==t&&"monthly"!==t)alert('Please select cron schedule frequency "On Every"');else{n&&n.match(/^([01]\d|2[0-3]):([0-5]\d)$/)?e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_get_save_cron_expression",nppp_cron_freq:t,nppp_time:n,_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(t){console.log(t),e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_get_active_cron_events_ajax",_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(t){e(".scheduled-events-list").empty(),t.data.forEach((function(t){var n='<div class="nppp-scheduled-event">';n+='<h3 class="nppp-active-cron-heading">Cron Status</h3>',n+='<div class="nppp-cron-info">',n+='<span class="nppp-hook-name">Cron Name: <strong>'+t.hook_name+"</strong></span> - ",n+='<span class="nppp-next-run">Next Run: <strong>'+t.next_run+"</strong></span>",n+="</div>",n+='<div class="nppp-cancel-btn-container">',n+='<button class="nppp-cancel-btn" data-hook="'+t.hook_name+'">Cancel</button>',n+="</div>",n+="</div>",e(".scheduled-events-list").append(n);var o=e(".scheduled-events-list").find(".nppp-next-run:last");o.css({"background-color":"darkorange",color:"white"});for(var s=0;s<8;s++)o.fadeOut(100).fadeIn(100);setTimeout((function(){o.css({"background-color":"",color:""})}),1600)}))},error:function(e,t,n){console.error(e.responseText)}})},error:function(t,n,o){e(".scheduled-events-list").empty();e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">Please set your Timezone in Wordpress - Options/General!</div></div>'),console.error(t.responseText)}}):alert('Please select cron "Time"')}})),e("#nginx_cache_schedule").prop("checked")||e("#nginx-cache-schedule-set").prop("disabled",!0),e("#nginx_cache_schedule").change((function(){var t=jQuery(this).next(".nppp-onoffswitch-label-schedule"),o=t.offset(),s=o.left+t.outerWidth()+10,a=o.top,p=e(this).prop("checked")?"yes":"no";e("#nginx-cache-schedule-set").prop("disabled","no"===p),"yes"===p&&e("#nginx-cache-schedule-set").prop("disabled",!1),e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_cache_schedule_option",cache_schedule:p,_wpnonce:nppp_admin_data.cache_schedule_nonce},(function(t){if(t.success){var o=n.createElement("div");if(o.textContent="Saved",o.style.position="absolute",o.style.left=s+"px",o.style.top=a+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),1e3),"Option updated successfully. Unschedule success."===t.data){e(".scheduled-events-list").empty();'<h3 class="nppp-active-cron-heading">Cron Status</h3>','<div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div>',"</div>",e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div></div>')}}else e("#nginx_cache_schedule").prop("checked",!e("#nginx_cache_schedule").prop("checked")),alert("Error updating option!")}),"json")})),e(n).on("click",".nppp-cancel-btn",(function(){event.preventDefault();var t=e(this).data("hook");confirm('Are you sure you want to cancel the scheduled event "'+t+'"?')&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_cancel_scheduled_event",hook:t,_wpnonce:nppp_admin_data.cancel_scheduled_event_nonce},success:function(t){e(".scheduled-events-list").empty();e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div></div>'),console.log(t)},error:function(e,t,n){console.error(e.responseText),alert("An error occurred while canceling the scheduled event.")}})})),e("#clear-logs-button").on("click",(function(t){t.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_clear_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(t){e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_get_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(t){var n=t.data,o='<div class="logs-container"><div class="success-line"><span class="timestamp">'+n.substring(1,20)+"</span> "+n.substring(23)+'</div><div class="cursor blink">#</div></div>';e(".logs-container").html(o)},error:function(e,t,n){console.error("Error getting log content:",t,n)}})},error:function(e,t,n){console.error("AJAX request failed:",t,n)}})})),e("#api-key-button").on("click",(function(t){t.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_api_key_option",_wpnonce:nppp_admin_data.api_key_nonce},success:function(t){t.success?e("#nginx_cache_api_key").val(t.data):console.error(t.data)},error:function(e,t,n){console.error(n)}})})),e("#nginx-regex-reset-defaults").on("click",(function(t){t.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_default_reject_regex_option",_wpnonce:nppp_admin_data.reject_regex_nonce},success:function(t){t.success?e("#nginx_cache_reject_regex").val(t.data):console.error(t.data)},error:function(e,t,n){console.error(n)}})})),e("#nginx-extension-reset-defaults").on("click",(function(t){t.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_default_reject_extension_option",_wpnonce:nppp_admin_data.reject_extension_nonce},success:function(t){t.success?e("#nginx_cache_reject_extension").val(t.data):console.error(t.data)},error:function(e,t,n){console.error(n)}})})),e(n).off("click","#nppp-clear-plugin-cache-btn").on("click","#nppp-clear-plugin-cache-btn",(function(t){t.preventDefault();var o=e("#nppp-clear-plugin-cache-btn"),s=o.offset(),a=o.outerWidth(),p=n.createElement("div");p.className="nppp-loading-spinner",p.style.position="absolute",p.style.left=s.left+a+10+"px",p.style.top=s.top-12+"px",p.style.zIndex="9999",n.body.appendChild(p),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_clear_plugin_cache",_wpnonce:nppp_admin_data.plugin_cache_nonce},success:function(e){n.body.removeChild(p);var t=s.left+a+10,o=s.top-3,c=n.createElement("div");c.style.position="absolute",c.style.left=t+"px",c.style.top=o+"px",c.style.color="#fff",c.style.padding="8px 12px",c.style.transition="opacity 0.3s ease-in-out",c.style.opacity="1",c.style.zIndex="9999",c.style.fontSize="13px",c.style.fontWeight="700",c.style.borderRadius="4px",e.success?(c.textContent="Cache Cleared",c.style.backgroundColor="#50C878"):(c.textContent="Cache cannot be cleared",c.style.backgroundColor="#D32F2F"),n.body.appendChild(c),setTimeout((function(){c.style.opacity="0",setTimeout((function(){n.body.removeChild(c),e.success&&location.reload()}),300)}),1200)},error:function(e,t,o){n.body.removeChild(p);var c=s.left+a+10,i=s.top-3,r=n.createElement("div");r.textContent="An ajax error occured",r.style.position="absolute",r.style.left=c+"px",r.style.top=i+"px",r.style.backgroundColor="#D32F2F",r.style.color="#fff",r.style.padding="8px 12px",r.style.transition="opacity 0.3s ease-in-out",r.style.opacity="1",r.style.zIndex="9999",r.style.fontSize="13px",r.style.fontWeight="700",r.style.borderRadius="4px",n.body.appendChild(r),setTimeout((function(){r.style.opacity="0",setTimeout((function(){n.body.removeChild(r)}),300)}),2e3)}})})),e(n).off("click","#nppp-restart-systemd-service-btn").on("click","#nppp-restart-systemd-service-btn",(function(t){t.preventDefault();var o=e("#nppp-restart-systemd-service-btn"),s=o.offset(),a=o.outerWidth(),p=n.createElement("div");p.className="nppp-loading-spinner",p.style.position="absolute",p.style.left=s.left+a+10+"px",p.style.top=s.top-12+"px",p.style.zIndex="9999",n.body.appendChild(p),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_restart_systemd_service",_wpnonce:nppp_admin_data.systemd_service_nonce},success:function(e){n.body.removeChild(p);var t=s.left+a+10,o=s.top-3,c=n.createElement("div");c.style.position="absolute",c.style.left=t+"px",c.style.top=o+"px",c.style.color="#fff",c.style.padding="8px 12px",c.style.transition="opacity 0.3s ease-in-out",c.style.opacity="1",c.style.zIndex="9999",c.style.fontSize="13px",c.style.fontWeight="700",c.style.borderRadius="4px",e.success?(c.textContent="Service Restarted",c.style.backgroundColor="#50C878"):(c.textContent="Service cannot be restarted",c.style.backgroundColor="#D32F2F"),n.body.appendChild(c),setTimeout((function(){c.style.opacity="0",setTimeout((function(){n.body.removeChild(c)}),300)}),2e3)},error:function(){n.body.removeChild(p);var e=s.left+a+10,t=s.top-3,o=n.createElement("div");o.textContent="An ajax error occured",o.style.position="absolute",o.style.left=e+"px",o.style.top=t+"px",o.style.backgroundColor="#D32F2F",o.style.color="#fff",o.style.padding="8px 12px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="13px",o.style.fontWeight="700",o.style.borderRadius="4px",n.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){n.body.removeChild(o)}),300)}),2e3)}})})),e("#nginx_cache_send_mail").prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff")),e("#nginx_cache_send_mail").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff"))})),e("#nginx_cache_auto_preload").prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff")),e("#nginx_cache_auto_preload").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff"))})),e("#nginx_cache_api").prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff")),e("#nginx_cache_api").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff"))})),e("#nginx_cache_schedule").prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff")),e("#nginx_cache_schedule").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff"))})),e("#nginx_cache_purge_on_update").prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff")),e("#nginx_cache_purge_on_update").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff"))})),jQuery("#nppp-unique-id").click((function(e){var t=jQuery(this),o=t.find("span"),s=o.offset(),a=s.left+o.outerWidth()+10,p=s.top,c=t.data("unique-id"),i=n.createElement("input");i.value=c,n.body.appendChild(i),i.select(),n.execCommand("copy"),n.body.removeChild(i);var r=n.createElement("div");r.textContent="Copied to clipboard",r.style.position="absolute",r.style.left=a+"px",r.style.top=p+"px",r.style.backgroundColor="#50C878",r.style.color="#fff",r.style.padding="2px 5px",r.style.transition="opacity 0.3s ease-in-out",r.style.opacity="1",r.style.zIndex="9999",r.style.fontSize="12px",r.style.fontWeight="700",n.body.appendChild(r),setTimeout((function(){r.style.opacity="0",setTimeout((function(){n.body.removeChild(r)}),300)}),3e3)})),jQuery("#nppp-api-key").click((function(t){var o=jQuery(this).find("span"),s=o.offset(),a=s.left+o.outerWidth()+10,p=s.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_update_api_key_copy_value",_wpnonce:nppp_admin_data.api_key_copy_nonce},success:function(e){var t=e.data.api_key,o=n.createElement("input");o.value=t,n.body.appendChild(o),o.select(),n.execCommand("copy"),n.body.removeChild(o);var s=n.createElement("div");s.textContent="Copied to clipboard",s.style.position="absolute",s.style.left=a+"px",s.style.top=p+"px",s.style.backgroundColor="#50C878",s.style.color="#fff",s.style.padding="2px 5px",s.style.transition="opacity 0.3s ease-in-out",s.style.opacity="1",s.style.zIndex="9999",s.style.fontSize="12px",s.style.fontWeight="700",n.body.appendChild(s),setTimeout((function(){s.style.opacity="0",setTimeout((function(){n.body.removeChild(s)}),300)}),3e3)},error:function(e,t,n){console.error("Error fetching API key:",n)}})})),jQuery("#nppp-purge-url").click((function(t){var o=jQuery(this).find("span"),s=o.offset(),a=s.left+o.outerWidth()+10,p=s.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_rest_api_purge_url_copy",_wpnonce:nppp_admin_data.api_purge_url_copy_nonce},success:function(e){var t=e.data,o=n.createElement("input");o.value=t,n.body.appendChild(o),o.select(),n.execCommand("copy"),n.body.removeChild(o);var s=n.createElement("div");s.textContent="Copied to clipboard",s.style.position="absolute",s.style.left=a+"px",s.style.top=p+"px",s.style.backgroundColor="#50C878",s.style.color="#fff",s.style.padding="2px 5px",s.style.transition="opacity 0.3s ease-in-out",s.style.opacity="1",s.style.zIndex="9999",s.style.fontSize="12px",s.style.fontWeight="700",n.body.appendChild(s),setTimeout((function(){s.style.opacity="0",setTimeout((function(){n.body.removeChild(s)}),300)}),3e3)},error:function(e,t,n){console.error("Error fetching API key:",n)}})})),jQuery("#nppp-preload-url").click((function(t){var o=jQuery(this).find("span"),s=o.offset(),a=s.left+o.outerWidth()+10,p=s.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_rest_api_preload_url_copy",_wpnonce:nppp_admin_data.api_preload_url_copy_nonce},success:function(e){var t=e.data,o=n.createElement("input");o.value=t,n.body.appendChild(o),o.select(),n.execCommand("copy"),n.body.removeChild(o);var s=n.createElement("div");s.textContent="Copied to clipboard",s.style.position="absolute",s.style.left=a+"px",s.style.top=p+"px",s.style.backgroundColor="#50C878",s.style.color="#fff",s.style.padding="2px 5px",s.style.transition="opacity 0.3s ease-in-out",s.style.opacity="1",s.style.zIndex="9999",s.style.fontSize="12px",s.style.fontWeight="700",n.body.appendChild(s),setTimeout((function(){s.style.opacity="0",setTimeout((function(){n.body.removeChild(s)}),300)}),3e3)},error:function(e,t,n){console.error("Error fetching API key:",n)}})})),e("#nppp-accordion").accordion({collapsible:!0,heightStyle:"content"}),e('.nppp-cron-event-select option[value=""][disabled]').hide(),e("#nppp_cron_event").on("click",(function(){e('.nppp-cron-event-select option[value=""][disabled]').hide()})),e("#nppp-purge-button, #nppp-preload-button").on("click",(function(n){n.preventDefault(),e(this).prop("disabled",!0).addClass("disabled"),e("#nppp-loader-overlay").addClass("active").fadeIn(200);var o=e(this).attr("href");setTimeout((function(){t.location.href=o}),2e3)}));var f=e("#nginx_cache_api_key"),h=e("#api-key-button");function y(e){return e.length<=10?"*".repeat(e.length):"*".repeat(10)+e.slice(10)}function _(e){f.data("original-key",e),f.val(y(e))}_(f.val()),f.on("focus",(function(){var e=f.data("original-key");f.val(e)})),f.on("blur",(function(){var e=f.data("original-key");f.val(y(e))})),f.on("input",(function(){var e=f.val();f.data("original-key",e)})),h.on("click",(function(){setTimeout((function(){_(f.val())}),700)}));var g=f.closest("form");g.length&&g.on("submit",(function(e){var t=f.data("original-key");f.val(t)})),e(".nppp-submenu a").on("click",(function(t){t.preventDefault();var n=e(this).attr("href");e(n).length&&e("html, body").animate({scrollTop:e(n).offset().top-30},500)}));var m=e('#nppp-settings-form input[type="submit"]'),x=m.val(),v={},b=["#nginx_cache_path","#nginx_cache_cpu_limit","#nginx_cache_reject_regex","#nginx_cache_reject_extension","#nginx_cache_limit_rate","#nginx_cache_wait_request","#nginx_cache_email","#nginx_cache_tracking_opt_in","#nginx_cache_api_key"];function C(){var t=!1;b.forEach((function(n){var o=e(n),s=v[n];("checkbox"===o.attr("type")?o.is(":checked"):o.val())!==s&&(t=!0)})),t?m.hasClass("nppp-submit-changed")||(m.addClass("nppp-submit-changed"),m.val("Save Settings Now")):k()}function k(){m.hasClass("nppp-submit-changed")&&(m.removeClass("nppp-submit-changed"),m.val(x))}b.forEach((function(t){var n=e(t);"checkbox"===n.attr("type")?v[t]=n.is(":checked"):v[t]=n.val()})),e(b.join(", ")).on("input change",(function(){C()})),e("#nppp-settings-form").on("submit",(function(){k(),b.forEach((function(t){var n=e(t);"checkbox"===n.attr("type")?v[t]=n.is(":checked"):v[t]=n.val()}))})),e("#nppp-settings-form").on("reset",(function(){setTimeout((function(){k(),b.forEach((function(t){var n=e(t);"checkbox"===n.attr("type")?v[t]=n.is(":checked"):v[t]=n.val()}))}),0)}))})),
n.addEventListener("DOMContentLoaded",(function(){new tempusDominus.TempusDominus(n.getElementById("nppp_datetimepicker1Input"),{display:{viewMode:"clock",components:{date:!1,month:!1,year:!1,decades:!1,hours:!0,minutes:!0,seconds:!1},icons:{time:"dashicons dashicons-arrow-up-alt2",up:"dashicons dashicons-arrow-up-alt2",down:"dashicons dashicons-arrow-down-alt2"},inline:!1,theme:"auto"},localization:{dateFormats:{LT:"HH:mm"},hourCycle:"h23",format:"LT"},stepping:5})})),n.addEventListener("DOMContentLoaded",(function(){["#nginx_cache_path","#nginx_cache_email","#nginx_cache_reject_regex","#nginx_cache_api_key","#nginx_cache_reject_extension"].forEach((function(e){const t=n.querySelector(e);if(t){function o(){t.value=t.value.trim()}function s(){let e;do{e=t.value,t.value=t.value.replace(/[^a-zA-Z0-9\/\-_\.]/g,""),t.value=t.value.replace(/\/{2,}/g,"/"),t.value=t.value.replace(/\/(?:[_\-]+)(\/|$)/g,"/"),t.value=t.value.replace(/\/+$/,"")}while(e!==t.value)}"#nginx_cache_path"===e&&t.addEventListener("blur",s),t.addEventListener("blur",o),t.addEventListener("input",(function(){setTimeout(o,0)}));const a=t.closest("form");a&&a.addEventListener("submit",(function(){o(),"#nginx_cache_path"===e&&s()}))}}))})),n.addEventListener("DOMContentLoaded",(function(){var e=function(e){var n=t.location.href,o=n.split("?");if(o.length>=2){for(var s=o[0],a=o[1].split("&"),p=[],c=0;c<a.length;c++){var i=a[c].split("=");-1===e.indexOf(i[0])&&p.push(a[c])}return s+"?"+p.join("&")}return n}(["status_message","message_type"]);history.replaceState(null,n.title,e)})),n.addEventListener("DOMContentLoaded",(function(){var e=n.getElementById("nppp-settings-form");e&&e.addEventListener("submit",(function(){var e=n.getElementById("nppp-loader-overlay");e&&e.classList.add("active")}))})),n.addEventListener("DOMContentLoaded",(function(){const e=n.getElementById("nppp-nginx-tabs"),o=n.querySelector(".submit");function s(){const t=e.getBoundingClientRect();o.style.left=`${t.left}px`,o.style.width=`${t.width}px`,o.style.margin="0",o.style.padding="0"}s(),t.addEventListener("resize",s)}))}(jQuery,window,document);
