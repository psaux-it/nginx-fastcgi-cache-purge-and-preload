/**
 * JavaScript for FastCGI Cache Purge and Preload for Nginx
 * Description: This minified version of JavaScript file contains functions to manage FastCGI Cache Purge and Preload for Nginx plugin and interact with WordPress admin dashboard.
 * Version: 2.1.4
 * Author: Hasan CALISIR
 * Author Email: hasan.calisir@psauxit.com
 * Author URI: https://www.psauxit.com
 * License: GPL-2.0+
 */

!function(e){"use strict";const{__:n,_x:t,_n:a,_nx:o}=wp.i18n;e(document).ready((function(){const t=e("#nppp-loader-overlay"),a=e("#settings-content-placeholder"),o=e("#status-content-placeholder"),s=e("#premium-content-placeholder"),p=e(".nppp-premium-container"),i=e("#nppp-nginx-tabs"),c=i.find("a");function d(){e(".nppp-loader-fill").css({animation:"nppp-fill 2s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"none","-webkit-backdrop-filter":"none",transition:"none"}),t.addClass("active").fadeIn(50)}function r(){t.removeClass("active").fadeOut(50),e(".nppp-loader-fill").css({animation:"nppp-fill 5s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"blur(1px)","-webkit-backdrop-filter":"blur(1px)",transition:"opacity 0.3s ease, visibility 0.3s ease"})}let l=!1,u=null;function f(e){var n=document.querySelector(".nppp-scrollfab");n&&(e?(n.setAttribute("data-lock","true"),n.setAttribute("data-hidden","true")):(n.removeAttribute("data-lock"),window.dispatchEvent(new Event("scroll"))))}function h(n){switch(a.hide(),o.hide(),s.hide(),p.hide(),n){case"settings":g(),a.show(),function(n,t){var a=e(n);if(0!==a.length){var o=(t-350)/a.length,s=350;a.each((function(n,t){var a=e(t);setTimeout((function(){a.addClass("active"),setTimeout((function(){a.removeClass("active")}),o)}),s),s+=.6*o}))}}(".nppp-submenu ul li a",900),f(!1);break;case"status":d(),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_cache_status",_wpnonce:nppp_admin_data.cache_status_nonce},success:function(e){""!==e.trim()?(o.html(e).css("opacity",0).show(),function(){const{__:e,_x:n,_n:t,_nx:a}=wp.i18n;if(!["#npppphpFpmStatus","#npppphpPagesInCache","#npppphpProcessOwner","#npppphpWebServer","#npppcachePath","#nppppurgeStatus","#npppshellExec","#npppaclStatus","#nppppreloadStatus","#npppwgetStatus","#npppLibfuseVersion","#npppBindfsVersion","#nppppermIsolation","#npppcpulimitStatus","#npppsafexecStatus"].every((e=>document.querySelector(e))))return;document.querySelector("#npppphpFpmStatus").closest("tr");var o=document.getElementById("npppphpFpmStatus"),s=o.textContent.trim();o.textContent=s,o.style.fontSize="14px";let p=document.createElement("span"),i="";"false"===s?(o.style.color="red",p.classList.add("dashicons","dashicons-no"),i=" "+e("Required","fastcgi-cache-purge-and-preload-nginx")):"Not Found"===s?(o.style.color="orange",p.classList.add("dashicons","dashicons-clock"),i=" "+e("Not Determined","fastcgi-cache-purge-and-preload-nginx")):(o.style.color="green",p.classList.add("dashicons","dashicons-yes"),i=" "+e("Not Required","fastcgi-cache-purge-and-preload-nginx")),o.textContent="",o.appendChild(p),o.append(i);var c=document.getElementById("npppphpPagesInCache"),d=c.textContent.trim();c.style.fontSize="14px";let r=document.createElement("span"),l="";"Undetermined"===d?(c.style.color="red",r.classList.add("dashicons","dashicons-no"),l=" "+e("Fix Permission","fastcgi-cache-purge-and-preload-nginx")):"RegexError"===d?(c.style.color="red",r.classList.add("dashicons","dashicons-no"),l=" "+e("Fix Regex","fastcgi-cache-purge-and-preload-nginx")):"0"===d?(c.style.color="orange",r.classList.add("dashicons","dashicons-clock"),l=" "+d):"Not Found"===d?(c.style.color="orange",r.classList.add("dashicons","dashicons-clock"),l=" "+e("Not Determined","fastcgi-cache-purge-and-preload-nginx")):(c.style.color="green",r.classList.add("dashicons","dashicons-yes"),l=" "+d),c.textContent="",c.appendChild(r),c.append(l);var u=document.getElementById("npppphpProcessOwner"),f=u.textContent.trim();u.style.fontSize="14px",u.style.color="green",u.textContent="";let h=document.createElement("span");h.classList.add("dashicons","dashicons-arrow-right-alt"),h.style.fontSize="16px",u.appendChild(h),u.append(" "+f);var g=document.getElementById("npppphpWebServer"),m=g.textContent.trim();g.style.fontSize="14px",g.textContent="";let _=document.createElement("span");_.style.fontSize="16px","dummy"===m.toLowerCase()||"not determined"===m.toLowerCase()?(_.classList.add("dashicons","dashicons-clock"),g.style.color="orange",g.appendChild(_),g.append(" "+e("Not Determined","fastcgi-cache-purge-and-preload-nginx"))):(_.classList.add("dashicons","dashicons-arrow-right-alt"),g.style.color="green",g.appendChild(_),g.append(" "+m));var y=document.getElementById("npppcachePath"),x=y.textContent.trim();y.style.fontSize="14px",y.textContent="";let v=document.createElement("span");v.style.fontSize="20px","Found"===x?(y.style.color="green",v.classList.add("dashicons","dashicons-yes"),y.appendChild(v),y.append(" ",e("Found","fastcgi-cache-purge-and-preload-nginx"))):"Not Found"===x&&(y.style.color="red",v.classList.add("dashicons","dashicons-no"),y.appendChild(v),y.append(" ",e("Not Found","fastcgi-cache-purge-and-preload-nginx")));var b=document.getElementById("nppppurgeStatus"),w=b.textContent.trim();b.style.fontSize="14px",b.textContent="";let C=document.createElement("span");C.style.fontSize="20px","true"===w?(b.style.color="green",C.classList.add("dashicons","dashicons-yes"),b.appendChild(C),b.append(" ",e("Ready","fastcgi-cache-purge-and-preload-nginx"))):"false"===w?(b.style.color="red",C.classList.add("dashicons","dashicons-no"),b.appendChild(C),b.append(" ",e("Not Ready","fastcgi-cache-purge-and-preload-nginx"))):(b.style.color="orange",C.classList.add("dashicons","dashicons-clock"),b.appendChild(C),b.append(" ",e("Not Determined","fastcgi-cache-purge-and-preload-nginx")));var k=document.getElementById("npppshellExec"),T=k.textContent.trim();k.style.fontSize="14px",k.textContent="";let S=document.createElement("span");S.style.fontSize="20px","Ok"===T?(k.style.color="green",S.classList.add("dashicons","dashicons-yes"),k.appendChild(S),k.append(" ",e("Allowed","fastcgi-cache-purge-and-preload-nginx"))):"Not Ok"===T&&(k.style.color="red",S.classList.add("dashicons","dashicons-no"),k.appendChild(S),k.append(" ",e("Not Allowed","fastcgi-cache-purge-and-preload-nginx")));var E=document.getElementById("npppaclStatus"),j=E.textContent.trim();E.textContent="",E.style.fontSize="14px";let L=document.createElement("span"),I="",P=document.createElement("span");if(j.includes("Granted")){E.style.color="green",L.classList.add("dashicons","dashicons-yes"),I=" "+e("Granted","fastcgi-cache-purge-and-preload-nginx")+" ";var A=j.replace("Granted","").trim();A&&(P.textContent=A,P.style.color="darkorange")}else j.includes("Need Action")?(E.style.color="red",L.classList.add("dashicons","dashicons-no"),I=" "+e("Need Action","fastcgi-cache-purge-and-preload-nginx")):(E.style.color="orange",L.classList.add("dashicons","dashicons-clock"),I=" "+e("Not Determined","fastcgi-cache-purge-and-preload-nginx"));E.appendChild(L),E.append(I),P.textContent&&E.appendChild(P),document.querySelector("#nppppreloadStatus").closest("tr").querySelector("#nppppreloadStatus");var z=document.getElementById("nppppreloadStatus"),N=z.textContent.trim();z.dataset.statusRaw=N,z.textContent="",z.style.fontSize="14px";let D=document.createElement("span"),B="";"true"===N?(z.style.color="green",D.classList.add("dashicons","dashicons-yes"),B=" "+e("Ready","fastcgi-cache-purge-and-preload-nginx")):"false"===N&&(z.style.color="red",D.classList.add("dashicons","dashicons-no"),B=" "+e("Not Ready","fastcgi-cache-purge-and-preload-nginx")),z.appendChild(D),z.append(B);var O=document.getElementById("npppwgetStatus"),R=O.textContent.trim();O.textContent="",O.style.fontSize="14px";let W=document.createElement("span"),q="";"Installed"===R?(O.style.color="green",W.classList.add("dashicons","dashicons-yes"),q=" "+e("Installed","fastcgi-cache-purge-and-preload-nginx")):"Not Installed"===R&&(O.style.color="red",W.classList.add("dashicons","dashicons-no"),q=" "+e("Not Installed","fastcgi-cache-purge-and-preload-nginx")),O.appendChild(W),O.append(q);var M=document.getElementById("npppLibfuseVersion"),F=M.textContent.trim();M.style.fontSize="14px",M.style.fontWeight="bold",M.textContent="";let $=document.createElement("span"),H="";if("Not Installed"===F)M.style.color="orange",$.classList.add("dashicons","dashicons-warning"),$.style.fontSize="18px",H=" "+F;else if(F.includes("(Not Determined)")){var G=F.split(" ")[0];$.classList.add("dashicons","dashicons-yes"),$.style.fontSize="20px",$.style.color="green",H=` ${G} <span style="color:orange;">(${e("Not Determined","fastcgi-cache-purge-and-preload-nginx")})</span>`}else F.includes("(")?(X=F.match(/(\d+\.\d+\.\d+)\s\((\d+\.\d+\.\d+)\)/))&&((G=X[1])===(Y=X[2])?(M.style.color="green",$.classList.add("dashicons","dashicons-yes"),$.style.fontSize="20px",$.style.color="green",H=` ${G} (${Y})`):($.classList.add("dashicons","dashicons-update"),$.style.fontSize="18px",$.style.color="orange",H=`<span style="color:orange;">${G}</span> <span style="color:green;">(${Y})</span>`)):(M.style.color="green",$.classList.add("dashicons","dashicons-yes"),$.style.fontSize="20px",$.style.color="green",H=" "+F);M.appendChild($),M.insertAdjacentHTML("beforeend",H);var Q=document.getElementById("npppBindfsVersion"),U=Q.textContent.trim();Q.style.fontSize="14px",Q.style.fontWeight="bold",Q.textContent="";let J=document.createElement("span"),V="";if("Not Installed"===U)Q.style.color="orange",J.classList.add("dashicons","dashicons-warning"),J.style.fontSize="18px",V=" "+U;else if(U.includes("(Not Determined)"))G=U.split(" ")[0],J.classList.add("dashicons","dashicons-yes"),J.style.fontSize="20px",J.style.color="green",V=` ${G} <span style="color:orange;">(${e("Not Determined","fastcgi-cache-purge-and-preload-nginx")})</span>`;else if(U.includes("(")){var X,Y;(X=U.match(/(\d+\.\d+\.\d+)\s\((\d+\.\d+\.\d+)\)/))&&((G=X[1])===(Y=X[2])?(Q.style.color="green",J.classList.add("dashicons","dashicons-yes"),J.style.fontSize="20px",J.style.color="green",V=` ${G} (${Y})`):(J.classList.add("dashicons","dashicons-update"),J.style.fontSize="18px",J.style.color="orange",V=`<span style="color:orange;">${G}</span> <span style="color:green;">(${Y})</span>`))}else Q.style.color="green",J.classList.add("dashicons","dashicons-yes"),J.style.fontSize="20px",J.style.color="green",V=" "+U;Q.appendChild(J),Q.insertAdjacentHTML("beforeend",V);var Z=document.getElementById("nppppermIsolation"),K=Z.textContent.trim();Z.textContent="",Z.style.fontSize="14px";let ee=document.createElement("span"),ne="";"Isolated"===K?(Z.style.color="green",ee.classList.add("dashicons","dashicons-yes"),ne=" "+e("Isolated","fastcgi-cache-purge-and-preload-nginx")):"Not Isolated"===K?(Z.style.color="orange",ee.classList.add("dashicons","dashicons-clock"),ne=" "+e("Not Isolated","fastcgi-cache-purge-and-preload-nginx")):"Not Determined"===K&&(Z.style.color="red",ee.classList.add("dashicons","dashicons-no"),ne=" "+e("Not Determined","fastcgi-cache-purge-and-preload-nginx")),Z.appendChild(ee),Z.append(ne);var te=document.getElementById("npppcpulimitStatus"),ae=te.textContent.trim();te.textContent="",te.style.fontSize="14px";let oe=document.createElement("span"),se="";"Installed"===ae?(te.style.color="green",oe.classList.add("dashicons","dashicons-yes"),se=" "+e("Installed","fastcgi-cache-purge-and-preload-nginx")):"Not Installed"===ae&&(te.style.color="red",oe.classList.add("dashicons","dashicons-no"),se=" "+e("Not Installed","fastcgi-cache-purge-and-preload-nginx")),te.appendChild(oe),te.append(se);var pe=document.getElementById("npppsafexecStatus"),ie=pe.textContent.trim();pe.textContent="",pe.style.fontSize="14px";let ce=document.createElement("span"),de="";"Installed"===ie?(pe.style.color="green",ce.classList.add("dashicons","dashicons-yes"),de=" "+e("Installed","fastcgi-cache-purge-and-preload-nginx")):"Not Installed"===ie&&(pe.style.color="red",ce.classList.add("dashicons","dashicons-no"),de=" "+e("Not Installed","fastcgi-cache-purge-and-preload-nginx")),pe.appendChild(ce),pe.append(de),document.querySelectorAll(".status").forEach((e=>{e.addEventListener("click",(()=>{e.querySelector(".dashicons").classList.add("spin"),setTimeout((()=>{e.querySelector(".dashicons").classList.remove("spin")}),1e3)}))}))}(),(async()=>{await new Promise((e=>setTimeout(e,100)));const e=document.getElementById("nppppreloadStatus"),n=document.getElementById("nppp-preload-progress-row");if(!e||!n)return;const t=e.dataset.statusRaw?.toLowerCase();"true"===t||"progress"===t?(n.style.display="",v||(v=!0,w())):n.style.display="none"})(),r(),o.animate({opacity:1},100)):(console.error("Empty response received"),r(),o.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                    '),o.show())},error:function(e,n,t){console.error(t),r(),o.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                '),o.show()}}),window.NPPPAurora&&"function"==typeof window.NPPPAurora.setProgressGate&&window.NPPPAurora.setProgressGate(!0),f(!0);const n=document.querySelector("#status");n&&(u||function(e){const n=new MutationObserver(((e,n)=>{const t=document.querySelector("#npppFuseMountStatus span:last-of-type");t&&("Not Mounted"===t.textContent.trim()&&function(e){try{const e=document.createElement("span");e.className="dashicons dashicons-warning",e.style.cssText="color: orange; margin-left: 8px; font-size: 28px;";const n=document.querySelector("#nppp-restart-systemd-service-btn");if(n){n.parentNode.insertBefore(e,n.nextSibling);const t=e.animate([{opacity:1},{opacity:0}],{duration:500,iterations:1/0,direction:"alternate"});setTimeout((()=>{t.cancel()}),2e3)}}catch(e){console.error("Error in warning icon insertion:",e)}}(),n.disconnect())}));u=n,n.observe(e,{childList:!0,subtree:!0})}(n));break;case"premium":d(),g(),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_load_premium_content",_wpnonce:nppp_admin_data.premium_content_nonce},success:function(n){if(""!==n.trim()){var t="#nppp-premium-table";if(e.fn.dataTable.isDataTable(t)&&e(t).DataTable().destroy(!0),s.stop(!0,!0).css("opacity",0).html(n).show(),function(){var n=e("#nppp-premium-table");if(n.length){if(e.fn.dataTable.isDataTable(n))return n.DataTable().columns.adjust().responsive.recalc(),void P();var t=n.DataTable({autoWidth:!1,responsive:!0,paging:!0,ordering:!0,searching:!0,lengthMenu:[10,25,50,100],pageLength:10,language:{paginate:{first:"First",last:"Last",next:"&#8594;",previous:"&#8592;"},search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)"},columnDefs:[{width:"23%",targets:0,className:"text-left"},{width:"37%",targets:1,className:"text-left"},{width:"8%",targets:2,className:"text-left"},{width:"5%",targets:3,className:"text-left"},{width:"12%",targets:4,className:"text-left"},{width:"15%",targets:5,className:"text-left"},{responsivePriority:1,targets:0},{responsivePriority:1e4,targets:[1,2,3,4,5]},{defaultContent:"",targets:"_all"}],initComplete:function(){P()}});n.off("page.dt.nppp").on("page.dt.nppp",(function(){e(this).find("tr.purged-row, tr.child.purged-row").removeClass("purged-row")})),t.on("draw",(function(){P()}))}}(),e.fn.dataTable.isDataTable(t)){var a=e(t).DataTable();a.columns.adjust(),a.responsive&&a.responsive.recalc()}r(),s.animate({opacity:1},100,(function(){if(e.fn.dataTable.isDataTable(t)){var n=e(t).DataTable();n.columns.adjust(),n.responsive&&n.responsive.recalc()}}))}else console.error("Empty response received for Premium tab."),r(),s.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                    '),s.show()},error:function(e,n,t){console.error(n+": "+t),r(),s.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                '),s.show()}}),f(!0);break;case"help":g(),p.show(),f(!0)}}function g(){u&&(u.disconnect(),u=null)}function m(){const e=window.location.hash;if(e){l=!0;const n=c.filter(`[href="${e}"]`).parent().index();-1!==n&&(i.tabs("option","active",n),h(e.replace("#","")),window.scrollTo(0,0),l=!1)}else h("settings")}function _(e,n="info"){return/success/i.test(e)?"success":/error|fail|denied|invalid/i.test(e)?"error":/info|notice|warning/i.test(e)?"info":n}function y(e,t="info",a=5500){const o=function(){let e=document.getElementById("nppp-toast-container");if(!e){e=document.createElement("div"),e.id="nppp-toast-container";const n=document.getElementById("wpadminbar");e.style.top=(n?n.offsetHeight+12:12)+"px",document.body.appendChild(e)}return e}(),s={success:"nppp-is-success",error:"nppp-is-error",info:"nppp-is-info",warning:"nppp-is-info"}[(t||"info").toLowerCase()]||"nppp-is-info",p=document.createElement("div");p.className="nppp-toast "+s,p.setAttribute("role","status"),p.setAttribute("aria-live","nppp-is-error"===s?"assertive":"polite"),p.innerHTML=`\n            <span class="nppp-ico" aria-hidden="true"></span>\n            <span class="nppp-close" aria-label="${n("Dismiss","fastcgi-cache-purge-and-preload-nginx")}">×</span>\n            <div class="nppp-msg"></div>\n        `,p.querySelector(".nppp-msg").innerHTML=e,p.querySelector(".nppp-close").onclick=()=>x(p),o.prepend(p);let i=setTimeout((()=>x(p)),a);p.addEventListener("mouseenter",(()=>clearTimeout(i))),p.addEventListener("mouseleave",(()=>i=setTimeout((()=>x(p)),1500)))}function x(e){e&&(e.style.animation="nppp-slide-out .14s ease-in forwards",setTimeout((()=>e.remove()),160))}i.hasClass("ui-tabs")||i.tabs({activate:function(e,n){const t=n.newPanel&&n.newPanel.attr("id"),a=n.oldPanel&&n.oldPanel.attr("id");if("status"===a&&"status"!==t&&(C(),g()),"status"===a&&"status"!==t&&window.NPPPAurora&&("function"==typeof window.NPPPAurora.setProgressGate&&window.NPPPAurora.setProgressGate(!1),"function"==typeof window.NPPPAurora.setMode&&window.NPPPAurora.setMode("idle"),"function"==typeof window.NPPPAurora.setProgressPercent&&window.NPPPAurora.setProgressPercent(0)),!l){const e=n.newPanel.attr("id");e&&(window.history.replaceState(null,null,`#${e}`),h(e))}l=!1},beforeLoad:function(e,n){"true"===n.tab.attr("aria-selected")||n.tab.closest(".ui-tabs-active").length>0||(n.jqXHR&&n.jqXHR.abort(),n.panel.html(""))}}),m(),function(){var n=e("#nppp-nginx-tabs");if(n.length&&!document.querySelector(".nppp-scrollfab")){var t=document.createElement("div");t.className="nppp-scrollfab",t.setAttribute("data-hidden","true");var a=document.createElement("button");a.type="button",a.setAttribute("aria-label","Back to top"),a.textContent="↑ Top";var o=document.createElement("button");function p(e){window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?window.scrollTo(0,e):window.scrollTo({top:e,behavior:"smooth"})}o.type="button",o.setAttribute("aria-label","Go to bottom"),o.textContent="↓ Bot",t.appendChild(a),t.appendChild(o),document.body.appendChild(t),a.addEventListener("click",(function(){p(0)})),o.addEventListener("click",(function(){p(document.documentElement.scrollHeight)}));var s=!0;function i(){if("true"!==t.getAttribute("data-lock")){var n=!e("#settings").is(":visible")||window.scrollY<400;n!==s&&(t.setAttribute("data-hidden",n?"true":"false"),s=n)}else"true"!==t.getAttribute("data-hidden")&&t.setAttribute("data-hidden","true")}window.addEventListener("scroll",i,{passive:!0}),i(),n.on("click",'a[href^="#"]',(function(n){var t=e(this).attr("href");if(t&&"#"!==t){var a=t.slice(1),o=document.getElementById(a);if(o){if(-1===["settings","status","premium","help"].indexOf(a)){n.preventDefault();var s,i=o.getBoundingClientRect();p(window.scrollY+i.top-(((s=document.getElementById("wpadminbar"))?s.offsetHeight:0)+8)-8),history.replaceState(null,"","#"+a)}}}})),n.on("tabsactivate",(function(){setTimeout(i,0)}))}}(),f("settings"!==(e("#nppp-nginx-tabs .ui-tabs-panel:visible").attr("id")||(location.hash||"#settings").slice(1))),e(window).on("hashchange",(function(){m()}));let v=!1,b=null;function w(){const t=document.getElementById("wpt-bar-text"),a=document.getElementById("wpt-bar-inner"),o=document.getElementById("wpt-status");if(v){if(e("#status").is(":visible"))return a&&o&&a.isConnected&&o.isConnected?void fetch(nppp_admin_data.wget_progress_api,{method:"GET",credentials:"same-origin",headers:{"X-WP-Nonce":nppp_admin_data.preload_progress_nonce}}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{if(!e.log_found){const e=document.getElementById("nppp-preload-progress-row");return e&&(e.style.display="none"),void C()}{const e=document.getElementById("nppp-preload-progress-row");e&&(e.style.display="")}const s=e.total||2e3;let p=Math.min(100,Math.round(e.checked/s*100));"done"===e.status&&(p=100),a.style.width=p+"%",t&&(t.textContent=p+"%");let i=`\n                <div class="nppp-progress-row">\n                    <span class="nppp-label">${n("Processed URLs:","fastcgi-cache-purge-and-preload-nginx")}</span> <code>${e.checked}</code>\n                    &nbsp;|&nbsp;\n                    <span class="nppp-label">${n("Broken URLs (404):","fastcgi-cache-purge-and-preload-nginx")}</span> <code>${e.errors}</code>\n                </div>\n                <div class="nppp-progress-row">\n                    <span class="nppp-label">${n("Last Processed Page:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                    <span class="nppp-url">${e.last_url}</span>\n                </div>\n            `;e.time&&(i+=`\n                    <div class="nppp-progress-row">\n                        <span class="nppp-label">${n("Time Elapsed:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                        <code>${e.time||"-"}</code>\n                        &nbsp;|&nbsp;\n                        <span class="nppp-label">${n("Last Preload:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                        <code>${e.last_preload_time||"-"}</code>\n                    </div>\n                `),(p>=100||"done"===e.status)&&(i+=`<div class="nppp-done">✅ <span>${n("Preload Complete","fastcgi-cache-purge-and-preload-nginx")}</span></div>`),o.innerHTML=i;const c=document.getElementById("nppppreloadStatus");if(c){const t=c.closest("td");c.textContent="",c.style.fontSize="14px";const a=document.createElement("span");let o="";if(t._npppAnimation||(t._npppAnimation=null),"done"===e.status)c.style.color="green",a.classList.add("dashicons","dashicons-yes"),o=" "+n("Ready","fastcgi-cache-purge-and-preload-nginx"),t._npppAnimation&&(t._npppAnimation.cancel(),t._npppAnimation=null),t&&(t.style.backgroundColor="inherit");else if("running"===e.status)c.style.color="orange",a.classList.add("dashicons","dashicons-clock"),o=" "+n("In Progress","fastcgi-cache-purge-and-preload-nginx"),t&&(t.style.backgroundColor="lightgreen",t._npppAnimation&&t._npppAnimation.cancel(),t._npppAnimation=t.animate([{backgroundColor:"#90ee90"}],{duration:1,iterations:1}));else{"true"===c.dataset.statusRaw?(c.style.color="green",a.classList.add("dashicons","dashicons-yes"),o=" "+n("Ready","fastcgi-cache-purge-and-preload-nginx")):(c.style.color="red",a.classList.add("dashicons","dashicons-no"),o=" "+n("Not Ready","fastcgi-cache-purge-and-preload-nginx")),t._npppAnimation&&(t._npppAnimation.cancel(),t._npppAnimation=null),t.style.backgroundColor="inherit"}c.appendChild(a),c.append(o)}p<100&&"running"===e.status?(b&&clearTimeout(b),b=setTimeout(w,800)):C()})).catch((e=>{console.error("Fetch preload progress failed:",e),C()})):(b&&clearTimeout(b),void(b=setTimeout(w,800)));C()}}function C(){v=!1,b&&clearTimeout(b),b=null}e(".nppp-action-trigger").on("click",(function(){d()}));var k=!1;function T(){return e.fn.dataTable.isDataTable("#nppp-premium-table")?e("#nppp-premium-table").DataTable():null}function S(e){var n=e.hasClass("child")?e.prev("tr"):e,t=n.next(".child");n.addClass("purged-row"),t.length&&t.addClass("purged-row"),setTimeout((function(){n.removeClass("purged-row"),t.length&&t.removeClass("purged-row")}),900)}function E(n,t){var a=n.hasClass("child")?n.prev("tr"):n,o=a.find("td.nppp-status");o.removeClass("is-hit is-miss").addClass(t?"is-hit":"is-miss").html("<strong>"+(t?"HIT":"MISS")+"</strong>");var s=T();s&&o.length&&s.cell(o[0]).invalidate("dom");var p=a.next(".child");if(p.length){var i=window.nppp_admin_data&&nppp_admin_data.col_cache_status?nppp_admin_data.col_cache_status:"Status";p.find(".dtr-details li").each((function(){var n=e(this);n.find(".dtr-title").text().trim()===i&&n.find(".dtr-data").removeClass("is-hit is-miss").addClass("nppp-status "+(t?"is-hit":"is-miss")).html("<strong>"+(t?"HIT":"MISS")+"</strong>")}))}}function j(n,t){var a=n.hasClass("child")?n.prev("tr"):n,o=a.find("td.nppp-cache-path");o.text(t);var s=T();s&&o.length&&s.cell(o[0]).invalidate("dom");var p=a.next(".child");if(p.length){var i=window.nppp_admin_data&&nppp_admin_data.col_cache_path?nppp_admin_data.col_cache_path:"Cache Path";p.find(".dtr-details li").each((function(){var n=e(this);n.find(".dtr-title").text().trim()===i&&n.find(".dtr-data").text(t)}))}}function L(e,n){var t,a=e.hasClass("child")?e.prev("tr"):e;(t=a.hasClass("dtr-expanded")?a.next(".child").find(".nppp-purge-btn"):a.find(".nppp-purge-btn")).attr("data-file",n),t.prop("disabled",!1).removeClass("disabled"),j(a,n)}function I(t,a,o,s){o=o||1;var p=(s=s||{}).maxAttempts||4,i=s.baseDelay||250,c=s.maxDelay||1500,d=1===o?null!=s.initialDelay?s.initialDelay:window.nppp_admin_data&&+nppp_admin_data.locate_initial_delay||400:0,r=Math.min(i*Math.pow(2,o-1),c);r+=Math.floor(60*Math.random());var l=t.hasClass("child")?t.prev("tr"):t;function u(e){return e&&e.length&&document.contains(e[0])}if(1===o){var f=window.nppp_admin_data&&nppp_admin_data.str_resolving_path?nppp_admin_data.str_resolving_path:"(resolving path…)";j(l,f),l.find("td.nppp-cache-path").addClass("is-resolving spinner--arc")}var h=Date.now()+":"+o;function g(){e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_locate_cache_file",cache_url:a,_wpnonce:nppp_admin_data.premium_nonce_locate}}).done((function(t){if(u(l)&&l.data("npppLocateReqId")===h)if(t&&t.success&&t.data&&t.data.file_path)E(l,!0),L(l,t.data.file_path),l.find("td.nppp-cache-path").removeClass("is-resolving spinner--arc"),l.removeData("npppLocateReqId"),k=!1,e(".nppp-preload-btn").prop("disabled",!1).removeClass("disabled");else if(o<p)setTimeout((function(){I(l,a,o+1,s)}),r);else{j(l,"—"),l.find("td.nppp-cache-path").removeClass("is-resolving spinner--arc");var i=String(a||"").trim();y(sprintf(n("Couldn't verify that the cache was warmed for %s. This URL may be bypassed by Nginx or the cache hasn't warmed yet. Refresh to recheck.","fastcgi-cache-purge-and-preload-nginx"),i),"info"),k=!1,e(".nppp-preload-btn").prop("disabled",!1).removeClass("disabled")}})).fail((function(){u(l)&&l.data("npppLocateReqId")===h&&(o<p?setTimeout((function(){u(l)&&I(l,a,o+1,s)}),r):(j(l,"—"),l.find("td.nppp-cache-path").removeClass("is-resolving spinner--arc")))}))}l.data("npppLocateReqId",h),d>0?setTimeout(g,d):g()}function P(){e("#nppp-premium-table tbody tr").each((function(){var n=e(this).find("td").eq(2);switch(n.text().trim()){case"POST":n.css({color:"fuchsia","font-weight":"bold"});break;case"AUTHOR":n.css({color:"orange","font-weight":"bold"});break;case"PAGE":n.css({color:"green","font-weight":"bold"});break;case"TAG":n.css({color:"blue","font-weight":"bold"});break;case"CATEGORY":n.css({color:"mediumslateblue","font-weight":"bold"});break;case"DAILY_ARCHIVE":n.css({color:"red","font-weight":"bold"});break;case"MONTHLY_ARCHIVE":n.css({color:"brown","font-weight":"bold"});break;case"YEARLY_ARCHIVE":n.css({color:"darkblue","font-weight":"bold"});break;case"DATE_ARCHIVE":n.css({color:"darkmagenta","font-weight":"bold"});break;case"PRODUCT":n.css({color:"coral","font-weight":"bold"});break;default:n.css({color:"burlywood","font-weight":"bold"})}}))}async function A(e){try{return await navigator.clipboard.writeText(String(e)),!0}catch(n){const t=document.createElement("input");t.value=String(e),document.body.appendChild(t),t.select();const a=document.execCommand("copy");return document.body.removeChild(t),a}}e(document).on("click",".nppp-purge-btn",(function(t){t.preventDefault();var a=e(this),o=a.data("file"),s=a.closest("tr");a.prop("disabled",!0).addClass("disabled");var p=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(a);e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_purge_cache_premium",file_path:o,_wpnonce:nppp_admin_data.premium_nonce_purge},success:function(t){var o=function(e,n){if(!e)return n||"";var t=e.data;return"string"==typeof t?t:t&&"string"==typeof t.message?t.message:"string"==typeof e.message?e.message:n||""}(t,n("Purge completed.","fastcgi-cache-purge-and-preload-nginx"));if(y(o,t&&t.success?"success":_(o,"error")),t&&t.success){var p;s.hasClass("child")&&(s=s.prev("tr")),E(s,!1),j(s,"—"),(p=s.hasClass("dtr-expanded")?s.next(".child").find(".nppp-preload-btn"):s.find(".nppp-preload-btn")).hasClass("nppp-general")||(p.css("background-color","#43A047"),p.prop("disabled",!1),p.removeClass("disabled"),setTimeout((function(){p.css("background-color","")}),1200)),"rgb(67, 160, 71)"===a.css("background-color")&&a.css("background-color",""),S(s);var i=t&&t.data&&t.data.affected_urls,c=!!(t&&t.data&&t.data.preload_auto);if(i&&Array.isArray(i)&&i.length){var d=s.find("td.nppp-url").text().trim();i.forEach((function(n){if(n=String(n||"").trim()){var t=function(n){if(!n)return e();n=String(n).trim();var t=T();if(t){var a=e();return t.rows().every((function(){var t=e(this.node()),o=t.hasClass("child")?t.prev("tr"):t;if(o.find("td.nppp-url").text().trim()===n)return a=o,!1})),a}var o=e("#nppp-premium-table tbody tr").filter((function(){return(e(this).hasClass("child")?e(this).prev("tr"):e(this)).find("td.nppp-url").text().trim()===n})).first();return o.hasClass("child")?o.prev("tr"):o}(n);t.length&&(d&&n===d||c||function(e){if(e&&e.length){var n=e.hasClass("child")?e.prev("tr"):e;E(n,!1),j(n,"—"),(n.hasClass("dtr-expanded")?n.next(".child").find(".nppp-purge-btn"):n.find(".nppp-purge-btn")).prop("disabled",!0).addClass("disabled").removeAttr("data-file");var t=n.hasClass("dtr-expanded")?n.next(".child").find(".nppp-preload-btn"):n.find(".nppp-preload-btn");t.length&&!t.hasClass("nppp-general")&&t.prop("disabled",!1).removeClass("disabled"),S(n);var a=T();a&&a.row(n[0]).invalidate("dom")}}(t))}}))}}else a.prop("disabled",!1).removeClass("disabled")},error:function(e,t,o){y(o||n("AJAX error","fastcgi-cache-purge-and-preload-nginx"),"error"),a.prop("disabled",!1).removeClass("disabled")},complete:function(){p.remove()}})})),e(document).on("click",".nppp-preload-btn",(function(t){if(t.preventDefault(),k)y(n("Preload is in progress, please wait…","fastcgi-cache-purge-and-preload-nginx"),"info");else{k=!0;var a=e(".nppp-preload-btn");a.prop("disabled",!0).addClass("disabled");var o=e(this),s=o.data("url"),p=o.closest("tr");o.prop("disabled",!0).addClass("disabled");var i=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(o);e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_preload_cache_premium",cache_url:s,_wpnonce:nppp_admin_data.premium_nonce_preload},success:function(t){var i=t&&t.data?t.data:n("Preload queued.","fastcgi-cache-purge-and-preload-nginx");if(y(i,t&&t.success?"success":_(i,"error")),t&&t.success){var c=p.find(".nppp-status").hasClass("is-miss")||p.hasClass("child")&&p.prev("tr").find(".nppp-status").hasClass("is-miss");p.hasClass("child")&&(p=p.prev("tr"));var d=p.hasClass("dtr-expanded")?p.next(".child").find(".nppp-purge-btn"):p.find(".nppp-purge-btn");S(p);var r=t&&t.data&&t.data.file_path?t.data.file_path:"";if(r)E(p,!0),L(p,r),d.css("background-color","#43A047"),setTimeout((function(){d.css("background-color","")}),1200),k=!1,e(".nppp-preload-btn").prop("disabled",!1).removeClass("disabled");else if(c){var l=window.nppp_admin_data&&nppp_admin_data.str_resolving_path?nppp_admin_data.str_resolving_path:"(Warming…)";j(p,l),p.find("td.nppp-cache-path").addClass("is-resolving spinner--arc"),I(p,s,1,{initialDelay:300})}else k=!1,e(".nppp-preload-btn").prop("disabled",!1).removeClass("disabled")}else k=!1,a.prop("disabled",!1).removeClass("disabled"),o.prop("disabled",!1).removeClass("disabled")},error:function(e,t,s){y(s||n("AJAX error","fastcgi-cache-purge-and-preload-nginx"),"error"),k=!1,a.prop("disabled",!1).removeClass("disabled"),o.prop("disabled",!1).removeClass("disabled")},complete:function(){i.remove()}})}})),function(){const t=e("#nppp-pctnorm");if(!t.length||!window.nppp_admin_data)return;const a=t.find('input[name="nginx_cache_settings[nginx_cache_pctnorm_mode]"]');if(!a.length)return;let o=a.filter(":checked").val();function s(n,a=!0){if(window.matchMedia&&window.matchMedia("(max-width: 782px)").matches){const e=a?"success":"error";return void y(String(n),e,3e3)}const o=t.offset();if(!o)return;const s=e("<div/>",{text:n,class:"nppp-mini-badge"}).css({position:"absolute",left:o.left+t.outerWidth()+10,top:o.top+2,backgroundColor:a?"#50C878":"#D32F2F",color:"#fff",padding:"6px 10px",fontSize:"12px",fontWeight:700,borderRadius:"4px",zIndex:9999,opacity:1,transition:"opacity .3s ease"}).appendTo(document.body);setTimeout((()=>{s.css("opacity",0),setTimeout((()=>s.remove()),300)}),1200)}const p=function(e,n){let t;return function(){clearTimeout(t),t=setTimeout((()=>e.apply(this,arguments)),n)}}((function(){if(t.hasClass("is-saving"))return;const p=a.filter(":checked");if(!p.length)return;const i=p.val();i!==o&&(t.addClass("is-saving"),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_update_pctnorm_mode",mode:i,_wpnonce:nppp_admin_data.pctnorm_nonce}}).done((function(e){if(e&&e.success)o=i,s(e.data&&e.data.message||n("Percent-encoding.","fastcgi-cache-purge-and-preload-nginx"),!0);else{a.filter('[value="'+o+'"]').prop("checked",!0);s(e&&(e.message||e.data&&e.data)||n("Failed to save.","fastcgi-cache-purge-and-preload-nginx"),!1)}})).fail((function(e){a.filter('[value="'+o+'"]').prop("checked",!0);const t=e&&e.responseJSON;s(t&&(t.message||t.data&&t.data)||n("Network error.","fastcgi-cache-purge-and-preload-nginx"),!1)})).always((function(){t.removeClass("is-saving")})))}),200);t.on("change",'input[name="nginx_cache_settings[nginx_cache_pctnorm_mode]"]',(function(){t.hasClass("is-saving")||p()}))}(),e("#nginx_cache_send_mail").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_send_mail_option",send_mail:s,_wpnonce:nppp_admin_data.send_mail_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_send_mail").prop("checked",!e("#nginx_cache_send_mail").prop("checked")),alert("Error updating option!")}),"json")})),e("#nginx_cache_auto_preload").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-preload"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_preload_option",auto_preload:s,_wpnonce:nppp_admin_data.auto_preload_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_auto_preload").prop("checked",!e("#nginx_cache_auto_preload").prop("checked")),alert("Error updating option!")}),"json")})),e("#nginx_cache_preload_enable_proxy").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-proxy"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_enable_proxy_option",enable_proxy:s,_wpnonce:nppp_admin_data.enable_proxy_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_preload_enable_proxy").prop("checked",!e("#nginx_cache_preload_enable_proxy").prop("checked")),alert("Error updating option!")}),"json")})),e("#nginx_cache_auto_preload_mobile").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-preload-mobile"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_preload_mobile_option",preload_mobile:s,_wpnonce:nppp_admin_data.auto_preload_mobile_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_auto_preload_mobile").prop("checked",!e("#nginx_cache_auto_preload_mobile").prop("checked")),alert("Error updating option!")}),"json")})),e("#nginx_cache_purge_on_update").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-autopurge"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_purge_option",auto_purge:s,_wpnonce:nppp_admin_data.auto_purge_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_purge_on_update").prop("checked",!e("#nginx_cache_purge_on_update").prop("checked")),alert("Error updating option!")}),"json")})),function(){const t=e(".nppp-related-pages").not("[data-nppp-rel-init]");t.length&&window.nppp_admin_data&&t.each((function(){const t=e(this).attr("data-nppp-rel-init","1"),a=t.find('[name="nginx_cache_settings[nppp_related_preload_after_manual]"]'),o=t.find('[name="nginx_cache_settings[nppp_related_include_home]"],[name="nginx_cache_settings[nppp_related_include_category]"],[name="nginx_cache_settings[nppp_related_apply_manual]"]'),s=e("<span/>",{class:"nppp-related-status","aria-live":"polite","aria-atomic":"true",role:"status"}).attr("data-state","idle").hide().insertAfter(t),p=()=>({nppp_related_include_home:t.find('[name="nginx_cache_settings[nppp_related_include_home]"]').is(":checked")?"yes":"no",nppp_related_include_category:t.find('[name="nginx_cache_settings[nppp_related_include_category]"]').is(":checked")?"yes":"no",nppp_related_apply_manual:t.find('[name="nginx_cache_settings[nppp_related_apply_manual]"]').is(":checked")?"yes":"no",nppp_related_preload_after_manual:t.find('[name="nginx_cache_settings[nppp_related_preload_after_manual]"]').is(":checked")?"yes":"no"}),i=e=>t.find("input[type=checkbox]").prop("disabled",e);let c;function d(e,n,t){clearTimeout(c),s.attr("data-state",e).html(n).show(),t&&(c=setTimeout((()=>{s.attr("data-state","idle").empty().hide()}),t))}const r=e=>d("error",'<span class="dashicons dashicons-dismiss" aria-hidden="true"></span><span class="nppp-sr-only">'+n("Error","fastcgi-cache-purge-and-preload-nginx")+"</span><span>"+(e||n("Failed to save","fastcgi-cache-purge-and-preload-nginx"))+"</span>",2e3),l=e=>{t.find('[name="nginx_cache_settings[nppp_related_include_home]"]').prop("checked","yes"===e.nppp_related_include_home),t.find('[name="nginx_cache_settings[nppp_related_include_category]"]').prop("checked","yes"===e.nppp_related_include_category),t.find('[name="nginx_cache_settings[nppp_related_apply_manual]"]').prop("checked","yes"===e.nppp_related_apply_manual),t.find('[name="nginx_cache_settings[nppp_related_preload_after_manual]"]').prop("checked","yes"===e.nppp_related_preload_after_manual),u()};function u(){const s=o.toArray().some((e=>e.checked));a.prop("disabled",!s).attr("aria-disabled",s?"false":"true"),s||a.prop("checked",!1);const p=t.find("#nppp_rel_preload + label .desc"),i=p.find(".nppp-hint");if(s)i.length&&i.remove();else if(!i.length){const t=e("<em/>",{class:"nppp-hint",html:'<span class="dashicons dashicons-lock" aria-hidden="true"></span><span>'+n("Enable at least one above to unlock this.","fastcgi-cache-purge-and-preload-nginx")+"</span>"});p.append(t)}}let f=p(),h=!1;u(),o.on("change",u),t.on("change","input[type=checkbox]",((e,n)=>{let t;return function(){clearTimeout(t),t=setTimeout(e,n)}})((function(){if(h)return;u(),h=!0,t.addClass("is-saving"),i(!0),d("saving",'<span class="dashicons dashicons-update" aria-hidden="true"></span><span class="nppp-sr-only">'+n("Saving","fastcgi-cache-purge-and-preload-nginx")+"</span><span>"+n("Saving…","fastcgi-cache-purge-and-preload-nginx")+"</span>");const a=p();e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",dataType:"json",timeout:15e3,data:{action:"nppp_update_related_fields",_wpnonce:nppp_admin_data.related_purge_nonce,fields:a}}).done((e=>{if(e&&e.success){const t=e.data&&(e.data.data||e.data.normalized||e.data)||a;f=t,l(t),d("saved",'<span class="dashicons dashicons-yes" aria-hidden="true"></span><span class="nppp-sr-only">'+n("Saved","fastcgi-cache-purge-and-preload-nginx")+"</span><span>"+n("Saved","fastcgi-cache-purge-and-preload-nginx")+"</span>",1e3)}else{l(f);const n=e&&(e.message||e.data&&e.data.message)||"Failed to save";r(n)}})).fail((e=>{l(f);const n=e&&e.responseJSON,t=n&&(n.message||n.data&&n.data.message)||"Network error";r(t)})).always((()=>{h=!1,t.removeClass("is-saving"),i(!1),u()}))}),350))}))}(),e("#nginx_cache_api").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-api"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_api_option",nppp_api:s,_wpnonce:nppp_admin_data.api_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_api").prop("checked",!e("#nginx_cache_api").prop("checked")),alert("Error updating option!")}),"json")})),e("#nginx-cache-schedule-set").on("click",(function(n){n.preventDefault();var t=e("#nppp_cron_event").val(),a=e("#nppp_datetimepicker1Input").val();if(!t||"daily"!==t&&"weekly"!==t&&"monthly"!==t)alert('Please select cron schedule frequency "On Every"');else{a&&a.match(/^([01]\d|2[0-3]):([0-5]\d)$/)?e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_get_save_cron_expression",nppp_cron_freq:t,nppp_time:a,_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(n){console.log(n),e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",dataType:"json",data:{action:"nppp_get_active_cron_events_ajax",_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(n){e(".scheduled-events-list").empty(),n.data.forEach((function(n){var t='<div class="nppp-scheduled-event">';t+='<h3 class="nppp-active-cron-heading">Cron Status</h3>',t+='<div class="nppp-cron-info">',t+='<span class="nppp-hook-name">Cron Name: <strong>'+n.hook_name+"</strong></span> - ",t+='<span class="nppp-next-run">Next Run: <strong>'+n.next_run+"</strong></span>",t+="</div>",t+='<div class="nppp-cancel-btn-container">',t+='<button class="nppp-cancel-btn" data-hook="'+n.hook_name+'">Cancel</button>',t+="</div>",t+="</div>",e(".scheduled-events-list").append(t);var a=e(".scheduled-events-list").find(".nppp-next-run:last");a.css({"background-color":"darkorange",color:"white"});for(var o=0;o<8;o++)a.fadeOut(100).fadeIn(100);setTimeout((function(){a.css({"background-color":"",color:""})}),1600)}))},error:function(e,n,t){console.error(e.responseText)}})},error:function(n,t,a){e(".scheduled-events-list").empty();e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">Please set your Timezone in Wordpress - Options/General!</div></div>'),console.error(n.responseText)}}):alert('Please select cron "Time"')}})),e("#nginx_cache_schedule").prop("checked")||e("#nginx-cache-schedule-set").prop("disabled",!0),e("#nginx_cache_schedule").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-schedule"),t=n.offset(),a=t.left+n.outerWidth()+10,o=t.top,s=e(this).prop("checked")?"yes":"no";e("#nginx-cache-schedule-set").prop("disabled","no"===s),"yes"===s&&e("#nginx-cache-schedule-set").prop("disabled",!1),e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_cache_schedule_option",cache_schedule:s,_wpnonce:nppp_admin_data.cache_schedule_nonce},(function(n){if(n.success){var t=document.createElement("div");if(t.textContent="✔",t.style.position="absolute",t.style.left=a+"px",t.style.top=o+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3),"Option updated successfully. Unschedule success."===n.data){e(".scheduled-events-list").empty();'<h3 class="nppp-active-cron-heading">Cron Status</h3>','<div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div>',"</div>",e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div></div>')}}else e("#nginx_cache_schedule").prop("checked",!e("#nginx_cache_schedule").prop("checked")),alert("Error updating option!")}),"json")})),e(document).on("click",".nppp-cancel-btn",(function(t){t.preventDefault();const a=e(this),o=a.data("hook");if(!o)return void y(n("Missing cron.","fastcgi-cache-purge-and-preload-nginx"),"error");a.prop("disabled",!0).addClass("disabled");const s=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(a);e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_cancel_scheduled_event",hook:o,_wpnonce:nppp_admin_data.cancel_scheduled_event_nonce}}).done((function(t){const a=t&&t.data?t.data:n("Scheduled event cancelled.","fastcgi-cache-purge-and-preload-nginx");y(a,t&&t.success?"success":_(a,"error")),e(".scheduled-events-list").empty().append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">'+n("Cron Status","fastcgi-cache-purge-and-preload-nginx")+'</h3><div class="nppp-scheduled-event" style="padding-right:45px;">'+n("No active scheduled events found!","fastcgi-cache-purge-and-preload-nginx")+"</div></div>"),window.wp&&wp.a11y&&"function"==typeof wp.a11y.speak&&wp.a11y.speak(n("Scheduled event cancelled.","fastcgi-cache-purge-and-preload-nginx"))})).fail((function(e){y(e&&e.responseJSON&&e.responseJSON.data?e.responseJSON.data:e&&e.responseText?e.responseText:n("An error occurred while canceling the scheduled event.","fastcgi-cache-purge-and-preload-nginx"),"error"),console.error(e)})).always((function(){s.remove(),a.prop("disabled",!1).removeClass("disabled")}))})),e("#clear-logs-button").on("click",(function(n){n.preventDefault();const t=e(this);t.prop("disabled",!0).addClass("disabled");const a=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(t);e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_clear_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(n){e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",dataType:"json",data:{action:"nppp_get_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(n){var t=n.data,a='<div class="logs-container"><div class="success-line"><span class="timestamp">'+t.substring(1,20)+"</span> "+t.substring(23)+'</div><div class="cursor blink">#</div></div>';e(".logs-container").html(a)},error:function(e,n,t){console.error("Error getting log content:",n,t)}}).always((function(){a.remove(),t.prop("disabled",!1).removeClass("disabled")}))},error:function(e,n,o){console.error("AJAX request failed:",n,o),a.remove(),t.prop("disabled",!1).removeClass("disabled")}})})),e("#api-key-button").on("click",(function(n){n.preventDefault();const t=e(this);t.prop("disabled",!0).addClass("disabled");const a=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(t);e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",dataType:"json",data:{action:"nppp_update_api_key_option",_wpnonce:nppp_admin_data.api_key_nonce},success:function(n){n.success?e("#nginx_cache_api_key").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)},complete:function(){a.remove(),t.prop("disabled",!1).removeClass("disabled")}})})),e("#nginx-regex-reset-defaults").on("click",(function(n){n.preventDefault();const t=e(this);t.prop("disabled",!0).addClass("disabled");const a=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(t);e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",dataType:"json",data:{action:"nppp_update_default_reject_regex_option",_wpnonce:nppp_admin_data.reject_regex_nonce},success:function(n){n.success?e("#nginx_cache_reject_regex").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)},complete:function(){a.remove(),t.prop("disabled",!1).removeClass("disabled")}})})),e("#nginx-extension-reset-defaults").on("click",(function(n){n.preventDefault();const t=e(this);t.prop("disabled",!0).addClass("disabled");const a=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(t);e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",dataType:"json",data:{action:"nppp_update_default_reject_extension_option",_wpnonce:nppp_admin_data.reject_extension_nonce},success:function(n){n.success?e("#nginx_cache_reject_extension").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)},complete:function(){a.remove(),t.prop("disabled",!1).removeClass("disabled")}})})),e("#nginx-key-regex-reset-defaults").on("click",(function(n){n.preventDefault();const t=e(this);t.prop("disabled",!0).addClass("disabled");const a=e('<span class="nppp-inline-spinner" aria-hidden="true"></span>').appendTo(t);e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",dataType:"json",data:{action:"nppp_update_default_cache_key_regex_option",_wpnonce:nppp_admin_data.cache_key_regex_nonce},success:function(n){n.success?e("#nginx_cache_key_custom_regex").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)},complete:function(){a.remove(),t.prop("disabled",!1).removeClass("disabled")}})})),e(document).off("click","#nppp-clear-plugin-cache-btn").on("click","#nppp-clear-plugin-cache-btn",(function(n){n.preventDefault();var t=e("#nppp-clear-plugin-cache-btn"),a=t.offset(),o=t.outerWidth(),s=document.createElement("div");s.className="nppp-loading-spinner",s.style.position="absolute",s.style.left=a.left+o+10+"px",s.style.top=a.top-12+"px",s.style.zIndex="9999",document.body.appendChild(s),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_clear_plugin_cache",_wpnonce:nppp_admin_data.plugin_cache_nonce},success:function(e){document.body.removeChild(s);var n=a.left+o+10,t=a.top-3,p=document.createElement("div");p.style.position="absolute",p.style.left=n+"px",p.style.top=t+"px",p.style.color="#fff",p.style.padding="8px 12px",p.style.transition="opacity 0.3s ease-in-out",p.style.opacity="1",p.style.zIndex="9999",p.style.fontSize="13px",p.style.fontWeight="700",p.style.borderRadius="4px",e.success?(p.textContent="Cache Cleared",p.style.backgroundColor="#50C878"):(p.textContent="Cache cannot be cleared",p.style.backgroundColor="#D32F2F"),document.body.appendChild(p),setTimeout((function(){p.style.opacity="0",setTimeout((function(){document.body.removeChild(p),e.success&&location.reload()}),300)}),1700)},error:function(e,n,t){document.body.removeChild(s);var p=a.left+o+10,i=a.top-3,c=document.createElement("div");c.textContent="An ajax error occured",c.style.position="absolute",c.style.left=p+"px",c.style.top=i+"px",c.style.backgroundColor="#D32F2F",c.style.color="#fff",c.style.padding="8px 12px",c.style.transition="opacity 0.3s ease-in-out",c.style.opacity="1",c.style.zIndex="9999",c.style.fontSize="13px",c.style.fontWeight="700",c.style.borderRadius="4px",document.body.appendChild(c),setTimeout((function(){c.style.opacity="0",setTimeout((function(){document.body.removeChild(c)}),300)}),2e3)}})})),e(document).off("click","#nppp-restart-systemd-service-btn").on("click","#nppp-restart-systemd-service-btn",(function(n){n.preventDefault();var t=e("#nppp-restart-systemd-service-btn"),a=t.offset(),o=t.outerWidth(),s=document.createElement("div");s.className="nppp-loading-spinner",s.style.position="absolute",s.style.left=a.left+o+10+"px",s.style.top=a.top-12+"px",s.style.zIndex="9999",document.body.appendChild(s),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",dataType:"json",data:{action:"nppp_restart_systemd_service",_wpnonce:nppp_admin_data.systemd_service_nonce},success:function(e){document.body.removeChild(s);var n=a.left+o+10,t=a.top-3,p=document.createElement("div");p.style.position="absolute",p.style.left=n+"px",p.style.top=t+"px",p.style.color="#fff",p.style.padding="8px 12px",p.style.transition="opacity 0.3s ease-in-out",p.style.opacity="1",p.style.zIndex="9999",p.style.fontSize="13px",p.style.fontWeight="700",p.style.borderRadius="4px",e.success?(p.textContent="Service Restarted",p.style.backgroundColor="#50C878"):(p.textContent="Service cannot be restarted",p.style.backgroundColor="#D32F2F"),document.body.appendChild(p),setTimeout((function(){p.style.opacity="0",setTimeout((function(){document.body.removeChild(p),e.success&&location.reload()}),300)}),1700)},error:function(){document.body.removeChild(s);var e=a.left+o+10,n=a.top-3,t=document.createElement("div");t.textContent="An ajax error occured",t.style.position="absolute",t.style.left=e+"px",t.style.top=n+"px",t.style.backgroundColor="#D32F2F",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",t.style.borderRadius="4px",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),2e3)}})})),e("#nginx_cache_send_mail").prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff")),e("#nginx_cache_send_mail").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff"))})),e("#nginx_cache_auto_preload").prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff")),e("#nginx_cache_auto_preload").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff"))})),e("#nginx_cache_auto_preload_mobile").prop("checked")?(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#66b317"),e(".nppp-on-preload-mobile").css("color","#ffffff"),e(".nppp-off-preload-mobile").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#ea1919"),e(".nppp-on-preload-mobile").css("color","#000000"),e(".nppp-off-preload-mobile").css("color","#ffffff")),e("#nginx_cache_auto_preload_mobile").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#66b317"),e(".nppp-on-preload-mobile").css("color","#ffffff"),e(".nppp-off-preload-mobile").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#ea1919"),e(".nppp-on-preload-mobile").css("color","#000000"),e(".nppp-off-preload-mobile").css("color","#ffffff"))})),e("#nginx_cache_preload_enable_proxy").prop("checked")?(e(".nppp-onoffswitch-switch-proxy").css("background","#66b317"),e(".nppp-on-proxy").css("color","#ffffff"),e(".nppp-off-proxy").css("color","#000000")):(e(".nppp-onoffswitch-switch-proxy").css("background","#ea1919"),e(".nppp-on-proxy").css("color","#000000"),e(".nppp-off-proxy").css("color","#ffffff")),e("#nginx_cache_preload_enable_proxy").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-proxy").css("background","#66b317"),e(".nppp-on-proxy").css("color","#ffffff"),e(".nppp-off-proxy").css("color","#000000")):(e(".nppp-onoffswitch-switch-proxy").css("background","#ea1919"),e(".nppp-on-proxy").css("color","#000000"),e(".nppp-off-proxy").css("color","#ffffff"))})),e("#nginx_cache_api").prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff")),e("#nginx_cache_api").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff"))})),e("#nginx_cache_schedule").prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff")),e("#nginx_cache_schedule").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff"))})),e("#nginx_cache_purge_on_update").prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff")),e("#nginx_cache_purge_on_update").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff"))})),jQuery("#nppp-unique-id").on("click",(async function(e){var n=jQuery(this),t=n.find("span"),a=t.offset(),o=a.left+t.outerWidth()+10,s=a.top,p=n.data("unique-id");await A(p);var i=document.createElement("div");i.textContent="Copied to clipboard",i.style.position="absolute",i.style.left=o+"px",i.style.top=s+"px",i.style.backgroundColor="#50C878",i.style.color="#fff",i.style.padding="2px 5px",i.style.transition="opacity 0.3s ease-in-out",i.style.opacity="1",i.style.zIndex="9999",i.style.fontSize="12px",i.style.fontWeight="700",document.body.appendChild(i),setTimeout((function(){i.style.opacity="0",setTimeout((function(){document.body.removeChild(i)}),300)}),2e3)})),jQuery("#nppp-api-key").click((function(n){var t=jQuery(this).find("span"),a=t.offset(),o=a.left+t.outerWidth()+10,s=a.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",dataType:"json",data:{action:"nppp_update_api_key_copy_value",_wpnonce:nppp_admin_data.api_key_copy_nonce},success:async function(e){var n=e.data.api_key;await A(n);var t=document.createElement("div");t.textContent="Copied to clipboard",t.style.position="absolute",t.style.left=o+"px",t.style.top=s+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="2px 5px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="12px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),2e3)},error:function(e,n,t){console.error("Error fetching API key:",t)}})})),jQuery("#nppp-purge-url").click((function(n){var t=jQuery(this).find("span"),a=t.offset(),o=a.left+t.outerWidth()+10,s=a.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",dataType:"json",data:{action:"nppp_rest_api_purge_url_copy",_wpnonce:nppp_admin_data.api_purge_url_copy_nonce},success:async function(e){var n=e.data;await A(n);var t=document.createElement("div");t.textContent="Copied to clipboard",t.style.position="absolute",t.style.left=o+"px",t.style.top=s+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="2px 5px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="12px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),2e3)},error:function(e,n,t){console.error("Error fetching Purge URL:",t)}})})),jQuery("#nppp-preload-url").click((function(n){var t=jQuery(this).find("span"),a=t.offset(),o=a.left+t.outerWidth()+10,s=a.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",dataType:"json",data:{action:"nppp_rest_api_preload_url_copy",_wpnonce:nppp_admin_data.api_preload_url_copy_nonce},success:async function(e){var n=e.data;await A(n);var t=document.createElement("div");t.textContent="Copied to clipboard",t.style.position="absolute",t.style.left=o+"px",t.style.top=s+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="2px 5px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="12px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),2e3)},error:function(e,n,t){console.error("Error fetching Preload URL:",t)}})})),e("#nppp-accordion").accordion({collapsible:!0,heightStyle:"content"}),e('.nppp-cron-event-select option[value=""][disabled]').hide(),e("#nppp_cron_event").on("click",(function(){e('.nppp-cron-event-select option[value=""][disabled]').hide()})),e("#nppp-purge-button, #nppp-preload-button").on("click",(function(n){n.preventDefault(),e(this).prop("disabled",!0).addClass("disabled"),e("#nppp-loader-overlay").addClass("active").fadeIn(200);var t=e(this).attr("href");setTimeout((function(){window.location.href=t}),500)}));var z=e("#nginx_cache_api_key"),N=e("#api-key-button");function D(e){return e.length<=10?"*".repeat(e.length):"*".repeat(10)+e.slice(10)}function B(e){z.data("original-key",e),z.val(D(e))}B(z.val()),z.on("focus",(function(){var e=z.data("original-key");z.val(e)})),z.on("blur",(function(){var e=z.data("original-key");z.val(D(e))})),z.on("input",(function(){var e=z.val();z.data("original-key",e)})),N.on("click",(function(){setTimeout((function(){B(z.val()),q["#nginx_cache_api_key"]=z.data("original-key")}),700)}));var O=z.closest("form");O.length&&O.on("submit",(function(e){var n=z.data("original-key");z.val(n)})),e(".nppp-submenu a").on("click",(function(n){n.preventDefault();var t=e(this).attr("href");e(t).length&&e("html, body").animate({scrollTop:e(t).offset().top-30},500)}));var R=e('#nppp-settings-form input[type="submit"]'),W=R.val(),q={},M=["#nginx_cache_path","#nginx_cache_cpu_limit","#nginx_cache_reject_regex","#nginx_cache_reject_extension","#nginx_cache_limit_rate","#nginx_cache_wait_request","#nginx_cache_email","#nginx_cache_tracking_opt_in","#nginx_cache_api_key","#nginx_cache_key_custom_regex","#nginx_cache_preload_proxy_port","#nginx_cache_preload_proxy_host"];function F(){var n=!1;M.forEach((function(t){var a=e(t),o=q[t];("#nginx_cache_api_key"===t?z.data("original-key"):"checkbox"===a.attr("type")?a.is(":checked"):a.val())!==o&&(n=!0)})),n?R.hasClass("nppp-submit-changed")||(R.addClass("nppp-submit-changed"),R.val("Save Settings Now")):$()}function $(){R.hasClass("nppp-submit-changed")&&(R.removeClass("nppp-submit-changed"),R.val(W))}M.forEach((function(n){var t=e(n);"#nginx_cache_api_key"===n?q[n]=z.data("original-key"):"checkbox"===t.attr("type")?q[n]=t.is(":checked"):q[n]=t.val()})),e(M.join(", ")).on("input change",(function(){F()})),e("#nppp-settings-form").on("submit",(function(){$(),M.forEach((function(n){var t=e(n);"checkbox"===t.attr("type")?q[n]=t.is(":checked"):q[n]=t.val()}))})),e("#nppp-settings-form").on("reset",(function(){setTimeout((function(){$(),M.forEach((function(n){var t=e(n);"checkbox"===t.attr("type")?q[n]=t.is(":checked"):q[n]=t.val()}))}),0)}))})),
document.addEventListener("DOMContentLoaded",(function(){new tempusDominus.TempusDominus(document.getElementById("nppp_datetimepicker1Input"),{display:{viewMode:"clock",components:{date:!1,month:!1,year:!1,decades:!1,hours:!0,minutes:!0,seconds:!1},icons:{time:"dashicons dashicons-arrow-up-alt2",up:"dashicons dashicons-arrow-up-alt2",down:"dashicons dashicons-arrow-down-alt2"},inline:!1,theme:"auto"},localization:{dateFormats:{LT:"HH:mm"},hourCycle:"h23",format:"LT"},stepping:5})})),document.addEventListener("DOMContentLoaded",(function(){["#nginx_cache_path","#nginx_cache_email","#nginx_cache_reject_regex","#nginx_cache_api_key","#nginx_cache_reject_extension","#nginx_cache_key_custom_regex"].forEach((function(e){const n=document.querySelector(e);if(n){function t(){n.value=n.value.trim()}function a(){let e;do{e=n.value,n.value=n.value.replace(/[^a-zA-Z0-9\/\-_\.]/g,""),n.value=n.value.replace(/\/{2,}/g,"/"),n.value=n.value.replace(/\/(?:[_\-]+)(\/|$)/g,"/"),n.value=n.value.replace(/\/+$/,"")}while(e!==n.value)}"#nginx_cache_path"===e&&n.addEventListener("blur",a),n.addEventListener("blur",t),n.addEventListener("input",(function(){setTimeout(t,0)}));const o=n.closest("form");o&&o.addEventListener("submit",(function(){t(),"#nginx_cache_path"===e&&a()}))}}))})),document.addEventListener("DOMContentLoaded",(function(){var e=function(e){var n=window.location.href,t=n.split("?");if(t.length>=2){for(var a=t[0],o=t[1].split("&"),s=[],p=0;p<o.length;p++){var i=o[p].split("=");-1===e.indexOf(i[0])&&s.push(o[p])}return s.length?a+"?"+s.join("&"):a}return n}(["status_message","message_type"]);history.replaceState(null,document.title,e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("nppp-settings-form");e&&e.addEventListener("submit",(function(){var e=document.getElementById("nppp-loader-overlay");e&&e.classList.add("active")}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("nppp-nginx-tabs"),n=document.querySelector("#nppp-settings-form .submit");function t(){if(!e||!n)return;const t=e.getBoundingClientRect();n.style.left=`${t.left}px`,n.style.width=`${t.width}px`,n.style.margin="0",n.style.padding="0"}const a=setInterval((()=>{const e=document.getElementById("nppp-nginx-tabs"),n=document.querySelector("#nppp-settings-form .submit");e&&n&&(clearInterval(a),t())}),10);window.addEventListener("resize",t)}));let s=null;const p=document.querySelector(".nppp-submenu ul");p&&p.addEventListener("click",(function(e){const n=e.target.closest("a");n&&(s&&s.classList.remove("active"),n.classList.add("active"),s=n)}))}(jQuery);
