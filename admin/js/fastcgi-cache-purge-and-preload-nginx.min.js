/**
 * JavaScript for FastCGI Cache Purge and Preload for Nginx
 * Description: This minified version of JavaScript file contains functions to manage FastCGI Cache Purge and Preload for Nginx plugin and interact with WordPress admin dashboard.
 * Version: 2.1.2
 * Author: Hasan CALISIR
 * Author Email: hasan.calisir@psauxit.com
 * Author URI: https://www.psauxit.com
 * License: GPL-2.0+
 */

!function(e){"use strict";const{__:n,_x:t,_n:o,_nx:a}=wp.i18n;e(document).ready((function(){const t=e("#nppp-loader-overlay"),o=e("#settings-content-placeholder"),a=e("#status-content-placeholder"),s=e("#premium-content-placeholder"),p=e(".nppp-premium-container"),c=e("#nppp-nginx-tabs"),i=c.find("a");function l(){e(".nppp-loader-fill").css({animation:"nppp-fill 2s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"none","-webkit-backdrop-filter":"none",transition:"none"}),t.addClass("active").fadeIn(50)}function d(){t.removeClass("active").fadeOut(50),e(".nppp-loader-fill").css({animation:"nppp-fill 5s ease-in-out infinite"}),e("#nppp-loader-overlay").css({"backdrop-filter":"blur(1px)","-webkit-backdrop-filter":"blur(1px)",transition:"opacity 0.3s ease, visibility 0.3s ease"})}let r=!1,u=null;function f(t){switch(o.hide(),a.hide(),s.hide(),p.hide(),t){case"settings":h(),o.show(),function(n,t){var o=e(n);if(0!==o.length){var a=(t-350)/o.length,s=350;o.each((function(n,t){var o=e(t);setTimeout((function(){o.addClass("active"),setTimeout((function(){o.removeClass("active")}),a)}),s),s+=.6*a}))}}(".nppp-submenu ul li a",900);break;case"status":l(),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_cache_status",_wpnonce:nppp_admin_data.cache_status_nonce},success:function(e){""!==e.trim()?(a.html(e).css("opacity",0).show(),function(){if(!["#npppphpFpmStatus","#npppphpPagesInCache","#npppphpProcessOwner","#npppphpWebServer","#npppcachePath","#nppppurgeStatus","#npppshellExec","#npppaclStatus","#nppppreloadStatus","#npppwgetStatus","#npppLibfuseVersion","#npppBindfsVersion","#nppppermIsolation","#npppcpulimitStatus"].every((e=>document.querySelector(e))))return;document.querySelector("#npppphpFpmStatus").closest("tr");var e=document.getElementById("npppphpFpmStatus"),t=e.textContent.trim();e.textContent=t,e.style.fontSize="14px";let o=document.createElement("span"),a="";"false"===t?(e.style.color="red",o.classList.add("dashicons","dashicons-no"),a=" "+n("Required","fastcgi-cache-purge-and-preload-nginx")):"Not Found"===t?(e.style.color="orange",o.classList.add("dashicons","dashicons-clock"),a=" "+n("Not Determined","fastcgi-cache-purge-and-preload-nginx")):(e.style.color="green",o.classList.add("dashicons","dashicons-yes"),a=" "+n("Not Required","fastcgi-cache-purge-and-preload-nginx")),e.textContent="",e.appendChild(o),e.append(a);var s=document.getElementById("npppphpPagesInCache"),p=s.textContent.trim();s.style.fontSize="14px";let c=document.createElement("span"),i="";"Undetermined"===p?(s.style.color="red",c.classList.add("dashicons","dashicons-no"),i=" "+n("Fix Permission","fastcgi-cache-purge-and-preload-nginx")):"RegexError"===p?(s.style.color="red",c.classList.add("dashicons","dashicons-no"),i=" "+n("Fix Regex","fastcgi-cache-purge-and-preload-nginx")):"0"===p?(s.style.color="orange",c.classList.add("dashicons","dashicons-clock"),i=" "+p):"Not Found"===p?(s.style.color="orange",c.classList.add("dashicons","dashicons-clock"),i=" "+n("Not Determined","fastcgi-cache-purge-and-preload-nginx")):(s.style.color="green",c.classList.add("dashicons","dashicons-yes"),i=" "+p),s.textContent="",s.appendChild(c),s.append(i);var l=document.getElementById("npppphpProcessOwner"),d=l.textContent.trim();l.style.fontSize="14px",l.style.color="green",l.textContent="";let r=document.createElement("span");r.classList.add("dashicons","dashicons-arrow-right-alt"),r.style.fontSize="16px",l.appendChild(r),l.append(" "+d);var u=document.getElementById("npppphpWebServer"),f=u.textContent.trim();u.style.fontSize="14px",u.style.color="green",u.textContent="";let h=document.createElement("span");h.classList.add("dashicons","dashicons-arrow-right-alt"),h.style.fontSize="16px",u.appendChild(h),u.append(" "+f);var y=document.getElementById("npppcachePath"),g=y.textContent.trim();y.style.fontSize="14px",y.textContent="";let m=document.createElement("span");m.style.fontSize="20px","Found"===g?(y.style.color="green",m.classList.add("dashicons","dashicons-yes"),y.appendChild(m),y.append(" ",n("Found","fastcgi-cache-purge-and-preload-nginx"))):"Not Found"===g&&(y.style.color="red",m.classList.add("dashicons","dashicons-no"),y.appendChild(m),y.append(" ",n("Not Found","fastcgi-cache-purge-and-preload-nginx")));var _=document.getElementById("nppppurgeStatus"),x=_.textContent.trim();_.style.fontSize="14px",_.textContent="";let b=document.createElement("span");b.style.fontSize="20px","true"===x?(_.style.color="green",b.classList.add("dashicons","dashicons-yes"),_.appendChild(b),_.append(" ",n("Ready","fastcgi-cache-purge-and-preload-nginx"))):"false"===x?(_.style.color="red",b.classList.add("dashicons","dashicons-no"),_.appendChild(b),_.append(" ",n("Not Ready","fastcgi-cache-purge-and-preload-nginx"))):(_.style.color="orange",b.classList.add("dashicons","dashicons-clock"),_.appendChild(b),_.append(" ",n("Not Determined","fastcgi-cache-purge-and-preload-nginx")));var v=document.getElementById("npppshellExec"),C=v.textContent.trim();v.style.fontSize="14px",v.textContent="";let k=document.createElement("span");k.style.fontSize="20px","Ok"===C?(v.style.color="green",k.classList.add("dashicons","dashicons-yes"),v.appendChild(k),v.append(" ",n("Allowed","fastcgi-cache-purge-and-preload-nginx"))):"Not Ok"===C&&(v.style.color="red",k.classList.add("dashicons","dashicons-no"),v.appendChild(k),v.append(" ",n("Not Allowed","fastcgi-cache-purge-and-preload-nginx")));var w=document.getElementById("npppaclStatus"),E=w.textContent.trim();w.textContent="",w.style.fontSize="14px";let S=document.createElement("span"),T="",L=document.createElement("span");if(E.includes("Granted")){w.style.color="green",S.classList.add("dashicons","dashicons-yes"),T=" "+n("Granted","fastcgi-cache-purge-and-preload-nginx")+" ";var j=E.replace("Granted","").trim();j&&(L.textContent=j,L.style.color="darkorange")}else E.includes("Need Action")?(w.style.color="red",S.classList.add("dashicons","dashicons-no"),T=" "+n("Need Action","fastcgi-cache-purge-and-preload-nginx")):(w.style.color="orange",S.classList.add("dashicons","dashicons-clock"),T=" "+n("Not Determined","fastcgi-cache-purge-and-preload-nginx"));w.appendChild(S),w.append(T),L.textContent&&w.appendChild(L),document.querySelector("#nppppreloadStatus").closest("tr").querySelector("#nppppreloadStatus");var I=document.getElementById("nppppreloadStatus"),z=I.textContent.trim();I.dataset.statusRaw=z,I.textContent="",I.style.fontSize="14px";let A=document.createElement("span"),N="";"true"===z?(I.style.color="green",A.classList.add("dashicons","dashicons-yes"),N=" "+n("Ready","fastcgi-cache-purge-and-preload-nginx")):"false"===z&&(I.style.color="red",A.classList.add("dashicons","dashicons-no"),N=" "+n("Not Ready","fastcgi-cache-purge-and-preload-nginx")),I.appendChild(A),I.append(N);var D=document.getElementById("npppwgetStatus"),P=D.textContent.trim();D.textContent="",D.style.fontSize="14px";let B=document.createElement("span"),W="";"Installed"===P?(D.style.color="green",B.classList.add("dashicons","dashicons-yes"),W=" "+n("Installed","fastcgi-cache-purge-and-preload-nginx")):"Not Installed"===P&&(D.style.color="red",B.classList.add("dashicons","dashicons-no"),W=" "+n("Not Installed","fastcgi-cache-purge-and-preload-nginx")),D.appendChild(B),D.append(W);var O=document.getElementById("npppLibfuseVersion"),R=O.textContent.trim();O.style.fontSize="14px",O.style.fontWeight="bold",O.textContent="";let q=document.createElement("span"),$="";if("Not Installed"===R)O.style.color="orange",q.classList.add("dashicons","dashicons-warning"),q.style.fontSize="18px",$=" "+R;else if(R.includes("(Not Determined)")){var F=R.split(" ")[0];q.classList.add("dashicons","dashicons-yes"),q.style.fontSize="20px",q.style.color="green",$=` ${F} <span style="color:orange;">(${n("Not Determined","fastcgi-cache-purge-and-preload-nginx")})</span>`}else R.includes("(")?(V=R.match(/(\d+\.\d+\.\d+)\s\((\d+\.\d+\.\d+)\)/))&&((F=V[1])===(U=V[2])?(O.style.color="green",q.classList.add("dashicons","dashicons-yes"),q.style.fontSize="20px",q.style.color="green",$=` ${F} (${U})`):(q.classList.add("dashicons","dashicons-update"),q.style.fontSize="18px",q.style.color="orange",$=`<span style="color:orange;">${F}</span> <span style="color:green;">(${U})</span>`)):(O.style.color="green",q.classList.add("dashicons","dashicons-yes"),q.style.fontSize="20px",q.style.color="green",$=" "+R);O.appendChild(q),O.insertAdjacentHTML("beforeend",$);var M=document.getElementById("npppBindfsVersion"),Q=M.textContent.trim();M.style.fontSize="14px",M.style.fontWeight="bold",M.textContent="";let G=document.createElement("span"),H="";if("Not Installed"===Q)M.style.color="orange",G.classList.add("dashicons","dashicons-warning"),G.style.fontSize="18px",H=" "+Q;else if(Q.includes("(Not Determined)"))F=Q.split(" ")[0],G.classList.add("dashicons","dashicons-yes"),G.style.fontSize="20px",G.style.color="green",H=` ${F} <span style="color:orange;">(${n("Not Determined","fastcgi-cache-purge-and-preload-nginx")})</span>`;else if(Q.includes("(")){var V,U;(V=Q.match(/(\d+\.\d+\.\d+)\s\((\d+\.\d+\.\d+)\)/))&&((F=V[1])===(U=V[2])?(M.style.color="green",G.classList.add("dashicons","dashicons-yes"),G.style.fontSize="20px",G.style.color="green",H=` ${F} (${U})`):(G.classList.add("dashicons","dashicons-update"),G.style.fontSize="18px",G.style.color="orange",H=`<span style="color:orange;">${F}</span> <span style="color:green;">(${U})</span>`))}else M.style.color="green",G.classList.add("dashicons","dashicons-yes"),G.style.fontSize="20px",G.style.color="green",H=" "+Q;M.appendChild(G),M.insertAdjacentHTML("beforeend",H);var Y=document.getElementById("nppppermIsolation"),X=Y.textContent.trim();Y.textContent="",Y.style.fontSize="14px";let J=document.createElement("span"),Z="";"Isolated"===X?(Y.style.color="green",J.classList.add("dashicons","dashicons-yes"),Z=" "+n("Isolated","fastcgi-cache-purge-and-preload-nginx")):"Not Isolated"===X?(Y.style.color="orange",J.classList.add("dashicons","dashicons-clock"),Z=" "+n("Not Isolated","fastcgi-cache-purge-and-preload-nginx")):"Not Determined"===X&&(Y.style.color="red",J.classList.add("dashicons","dashicons-no"),Z=" "+n("Not Determined","fastcgi-cache-purge-and-preload-nginx")),Y.appendChild(J),Y.append(Z);var K=document.getElementById("npppcpulimitStatus"),ee=K.textContent.trim();K.textContent="",K.style.fontSize="14px";let ne=document.createElement("span"),te="";"Installed"===ee?(K.style.color="green",ne.classList.add("dashicons","dashicons-yes"),te=" "+n("Installed","fastcgi-cache-purge-and-preload-nginx")):"Not Installed"===ee&&(K.style.color="red",ne.classList.add("dashicons","dashicons-no"),te=" "+n("Not Installed","fastcgi-cache-purge-and-preload-nginx")),K.appendChild(ne),K.append(te),document.querySelectorAll(".status").forEach((e=>{e.addEventListener("click",(()=>{e.querySelector(".dashicons").classList.add("spin"),setTimeout((()=>{e.querySelector(".dashicons").classList.remove("spin")}),1e3)}))}))}(),(async()=>{await new Promise((e=>setTimeout(e,100)));const e=document.getElementById("nppppreloadStatus"),n=document.getElementById("nppp-preload-progress-row");if(!e||!n)return;const t=e.dataset.statusRaw?.toLowerCase();"true"===t||"progress"===t?(n.style.display="",g()):n.style.display="none"})(),d(),a.animate({opacity:1},100)):(console.error("Empty response received"),d(),a.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                    '),a.show())},error:function(e,n,t){console.error(t),d(),a.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Status TAB.</p>\n                '),a.show()}});const t=document.querySelector("#status");t&&(u||function(e){const n=new MutationObserver(((e,n)=>{const t=document.querySelector("#npppFuseMountStatus span:last-of-type");t&&("Not Mounted"===t.textContent.trim()&&function(e){try{const e=document.createElement("span");e.className="dashicons dashicons-warning",e.style.cssText="color: orange; margin-left: 8px; font-size: 28px;";const n=document.querySelector("#nppp-restart-systemd-service-btn");if(n){n.parentNode.insertBefore(e,n.nextSibling);const t=e.animate([{opacity:1},{opacity:0}],{duration:500,iterations:1/0,direction:"alternate"});setTimeout((()=>{t.cancel()}),2e3)}}catch(e){console.error("Error in warning icon insertion:",e)}}(),n.disconnect())}));u=n,n.observe(e,{childList:!0,subtree:!0})}(t));break;case"premium":l(),h(),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_load_premium_content",_wpnonce:nppp_admin_data.premium_content_nonce},success:function(n){""!==n.trim()?(s.html(n).css("opacity",0).show(),e("#nppp-premium-table").DataTable({autoWidth:!1,responsive:!0,paging:!0,ordering:!0,searching:!0,lengthMenu:[10,25,50,100],pageLength:10,language:{paginate:{first:"First",last:"Last",next:"&#8594;",previous:"&#8592;"},search:"Search:",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",infoEmpty:"Showing 0 to 0 of 0 entries",infoFiltered:"(filtered from _MAX_ total entries)"},columnDefs:[{width:"21%",targets:0,className:"text-left"},{width:"37%",targets:1,className:"text-left"},{width:"10%",targets:2,className:"text-left"},{width:"5%",targets:3,className:"text-left"},{width:"12%",targets:4,className:"text-left"},{width:"15%",targets:5,className:"text-left"},{responsivePriority:1,targets:0},{responsivePriority:1e4,targets:[1,2,3,4,5]},{defaultContent:"",targets:"_all"}],initComplete:function(){m(),_()}}).on("draw",(function(){m(),_()})),e("#nppp-premium-table").DataTable().responsive.recalc(),d(),s.animate({opacity:1},100)):(console.error(status+": "+error),d(),s.html('\n                        <h2>Error Displaying Tab Content</h2>\n                        <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                    '),s.show())},error:function(e,n,t){console.error(n+": "+t),d(),s.html('\n                    <h2>Error Displaying Tab Content</h2>\n                    <p class="nppp-advanced-error-message">Failed to initialize the Advanced TAB.</p>\n                '),s.show()}});break;case"help":h(),p.show()}}function h(){u&&(u.disconnect(),u=null)}function y(){const e=window.location.hash;if(e){r=!0;const n=i.filter(`[href="${e}"]`).parent().index();-1!==n&&(c.tabs("option","active",n),f(e.replace("#","")),window.scrollTo(0,0),r=!1)}else f("settings")}function g(){const e=document.getElementById("wpt-bar-text"),t=document.getElementById("wpt-bar-inner"),o=document.getElementById("wpt-status");t&&o&&fetch(nppp_admin_data.wget_progress_api,{method:"GET",credentials:"same-origin",headers:{"X-WP-Nonce":nppp_admin_data.preload_progress_nonce}}).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((a=>{if(!a.log_found){const e=document.getElementById("nppp-preload-progress-row");return void(e&&(e.style.display="none"))}{const e=document.getElementById("nppp-preload-progress-row");e&&(e.style.display="")}const s=a.total||2e3;let p=Math.min(100,Math.round(a.checked/s*100));"done"===a.status&&(p=100),t.style.width=p+"%",e&&(e.textContent=p+"%");let c=`\n                <div class="nppp-progress-row">\n                    <span class="nppp-label">${n("Processed URLs:","fastcgi-cache-purge-and-preload-nginx")}</span> <code>${a.checked}</code>\n                    &nbsp;|&nbsp;\n                    <span class="nppp-label">${n("Broken URLs (404):","fastcgi-cache-purge-and-preload-nginx")}</span> <code>${a.errors}</code>\n                </div>\n                <div class="nppp-progress-row">\n                    <span class="nppp-label">${n("Last Processed Page:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                    <span class="nppp-url">${a.last_url}</span>\n                </div>\n            `;a.time&&(c+=`\n                    <div class="nppp-progress-row">\n                        <span class="nppp-label">${n("Time Elapsed:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                        <code>${a.time||"-"}</code>\n                        &nbsp;|&nbsp;\n                        <span class="nppp-label">${n("Last Preload:","fastcgi-cache-purge-and-preload-nginx")}</span>\n                        <code>${a.last_preload_time||"-"}</code>\n                    </div>\n                `),(p>=100||"done"===a.status)&&(c+=`<div class="nppp-done">✅ <span>${n("Preload Complete","fastcgi-cache-purge-and-preload-nginx")}</span></div>`),o.innerHTML=c;const i=document.getElementById("nppppreloadStatus");if(i){const e=i.closest("td");i.textContent="",i.style.fontSize="14px";const t=document.createElement("span");let o="";if(e._npppAnimation||(e._npppAnimation=null),"done"===a.status)i.style.color="green",t.classList.add("dashicons","dashicons-yes"),o=" "+n("Ready","fastcgi-cache-purge-and-preload-nginx"),e._npppAnimation&&(e._npppAnimation.cancel(),e._npppAnimation=null),e&&(e.style.backgroundColor="inherit");else if("running"===a.status)i.style.color="orange",t.classList.add("dashicons","dashicons-clock"),o=" "+n("In Progress","fastcgi-cache-purge-and-preload-nginx"),e&&(e.style.backgroundColor="lightgreen",e._npppAnimation&&e._npppAnimation.cancel(),e._npppAnimation=e.animate([{backgroundColor:"#90ee90"}],{duration:1,iterations:1}));else{"true"===i.dataset.statusRaw?(i.style.color="green",t.classList.add("dashicons","dashicons-yes"),o=" "+n("Ready","fastcgi-cache-purge-and-preload-nginx")):(i.style.color="red",t.classList.add("dashicons","dashicons-no"),o=" "+n("Not Ready","fastcgi-cache-purge-and-preload-nginx")),e._npppAnimation&&(e._npppAnimation.cancel(),e._npppAnimation=null),e.style.backgroundColor="inherit"}i.appendChild(t),i.append(o)}p<100&&"running"===a.status&&setTimeout(g,500)})).catch((e=>{console.error("Fetch preload progress failed:",e)}))}function m(){e("#nppp-premium-table tbody tr").each((function(){var n=e(this).find("td").eq(2);switch(n.text().trim()){case"POST":n.css({color:"fuchsia","font-weight":"bold"});break;case"AUTHOR":n.css({color:"orange","font-weight":"bold"});break;case"PAGE":n.css({color:"green","font-weight":"bold"});break;case"TAG":n.css({color:"blue","font-weight":"bold"});break;case"CATEGORY":n.css({color:"mediumslateblue","font-weight":"bold"});break;case"DAILY_ARCHIVE":n.css({color:"red","font-weight":"bold"});break;case"MONTHLY_ARCHIVE":n.css({color:"brown","font-weight":"bold"});break;case"YEARLY_ARCHIVE":n.css({color:"darkblue","font-weight":"bold"});break;case"DATE_ARCHIVE":n.css({color:"darkmagenta","font-weight":"bold"});break;case"PRODUCT":n.css({color:"coral","font-weight":"bold"});break;default:n.css({color:"burlywood","font-weight":"bold"})}e(this).find("td").eq(3).css({color:"green"})}))}function _(){document.querySelectorAll("#nppp-premium-table > tbody > tr").forEach((function(e){[e.querySelector("td:nth-child(2)"),e.querySelector("td:nth-child(3)"),e.querySelector("td:nth-child(4)"),e.querySelector("td:nth-child(5)")].forEach((function(e){""===e.textContent.trim()&&(e.style.display="none")}))}))}c.hasClass("ui-tabs")||c.tabs({activate:function(e,n){if(!r){const e=n.newPanel.attr("id");e&&(window.history.replaceState(null,null,`#${e}`),f(e))}r=!1},beforeLoad:function(e,n){"true"===n.tab.attr("aria-selected")||n.tab.closest(".ui-tabs-active").length>0||(n.jqXHR.abort(),n.panel.html(""))}}),y(),e(window).on("hashchange",(function(){y()})),e(".nppp-action-trigger").on("click",(function(){l()})),e(document).on("click",".nppp-purge-btn",(function(){var n=e(this),t=n.data("file"),o=n.closest("tr");confirm("Are you sure you want to purge cache?")&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_purge_cache_premium",file_path:t,_wpnonce:nppp_admin_data.premium_nonce_purge},success:function(t){var a;t.success?(alert(t.data),o.hasClass("child")&&(o=o.prev("tr")),a=o.hasClass("dtr-expanded")?o.next(".child").find(".nppp-preload-btn"):o.find(".nppp-preload-btn"),n.prop("disabled",!0),n.addClass("disabled"),a.hasClass("nppp-general")||(a.css("background-color","#43A047"),a.prop("disabled",!1),a.removeClass("disabled")),"rgb(67, 160, 71)"===n.css("background-color")&&n.css("background-color",""),e("tr.purged-row").removeClass("purged-row"),setTimeout((function(){o.addClass("purged-row")}),0)):alert(t.data)},error:function(e,n,t){alert(t)}})})),e(document).on("click",".nppp-preload-btn",(function(){var n=e(this),t=n.data("url"),o=n.closest("tr");confirm("Are you sure you want to preload cache?")&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_preload_cache_premium",cache_url:t,_wpnonce:nppp_admin_data.premium_nonce_preload},success:function(t){var a;t.success?(alert(t.data),o.hasClass("child")&&(o=o.prev("tr")),a=o.hasClass("dtr-expanded")?o.next(".child").find(".nppp-purge-btn"):o.find(".nppp-purge-btn"),n.prop("disabled",!0),n.addClass("disabled"),a.css("background-color","#43A047"),a.prop("disabled",!1),a.removeClass("disabled"),"rgb(67, 160, 71)"===n.css("background-color")&&n.css("background-color",""),e("tr.purged-row").removeClass("purged-row"),setTimeout((function(){o.addClass("purged-row")}),0)):alert(t.data)},error:function(e,n,t){alert(t)}})})),e("#nginx_cache_send_mail").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_send_mail_option",send_mail:s,_wpnonce:nppp_admin_data.send_mail_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_send_mail").prop("checked",!e("#nginx_cache_send_mail").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_auto_preload").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-preload"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_preload_option",auto_preload:s,_wpnonce:nppp_admin_data.auto_preload_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_auto_preload").prop("checked",!e("#nginx_cache_auto_preload").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_preload_enable_proxy").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-proxy"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_enable_proxy_option",enable_proxy:s,_wpnonce:nppp_admin_data.enable_proxy_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_preload_enable_proxy").prop("checked",!e("#nginx_cache_preload_enable_proxy").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_auto_preload_mobile").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-preload-mobile"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_preload_mobile_option",preload_mobile:s,_wpnonce:nppp_admin_data.auto_preload_mobile_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_auto_preload_mobile").prop("checked",!e("#nginx_cache_auto_preload_mobile").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_purge_on_update").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-autopurge"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_auto_purge_option",auto_purge:s,_wpnonce:nppp_admin_data.auto_purge_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_purge_on_update").prop("checked",!e("#nginx_cache_purge_on_update").prop("checked")),alert("Error updating option!")}))})),e("#nginx_cache_api").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-api"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_api_option",nppp_api:s,_wpnonce:nppp_admin_data.api_nonce},(function(n){if(n.success){var t=document.createElement("div");t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3)}else e("#nginx_cache_api").prop("checked",!e("#nginx_cache_api").prop("checked")),alert("Error updating option!")}))})),e("#nginx-cache-schedule-set").on("click",(function(){event.preventDefault();var n=e("#nppp_cron_event").val(),t=e("#nppp_datetimepicker1Input").val();if(!n||"daily"!==n&&"weekly"!==n&&"monthly"!==n)alert('Please select cron schedule frequency "On Every"');else{t&&t.match(/^([01]\d|2[0-3]):([0-5]\d)$/)?e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_get_save_cron_expression",nppp_cron_freq:n,nppp_time:t,_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(n){console.log(n),e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_get_active_cron_events_ajax",_wpnonce:nppp_admin_data.get_save_cron_nonce},success:function(n){e(".scheduled-events-list").empty(),n.data.forEach((function(n){var t='<div class="nppp-scheduled-event">';t+='<h3 class="nppp-active-cron-heading">Cron Status</h3>',t+='<div class="nppp-cron-info">',t+='<span class="nppp-hook-name">Cron Name: <strong>'+n.hook_name+"</strong></span> - ",t+='<span class="nppp-next-run">Next Run: <strong>'+n.next_run+"</strong></span>",t+="</div>",t+='<div class="nppp-cancel-btn-container">',t+='<button class="nppp-cancel-btn" data-hook="'+n.hook_name+'">Cancel</button>',t+="</div>",t+="</div>",e(".scheduled-events-list").append(t);var o=e(".scheduled-events-list").find(".nppp-next-run:last");o.css({"background-color":"darkorange",color:"white"});for(var a=0;a<8;a++)o.fadeOut(100).fadeIn(100);setTimeout((function(){o.css({"background-color":"",color:""})}),1600)}))},error:function(e,n,t){console.error(e.responseText)}})},error:function(n,t,o){e(".scheduled-events-list").empty();e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">Please set your Timezone in Wordpress - Options/General!</div></div>'),console.error(n.responseText)}}):alert('Please select cron "Time"')}})),e("#nginx_cache_schedule").prop("checked")||e("#nginx-cache-schedule-set").prop("disabled",!0),e("#nginx_cache_schedule").change((function(){var n=jQuery(this).next(".nppp-onoffswitch-label-schedule"),t=n.offset(),o=t.left+n.outerWidth()+10,a=t.top,s=e(this).prop("checked")?"yes":"no";e("#nginx-cache-schedule-set").prop("disabled","no"===s),"yes"===s&&e("#nginx-cache-schedule-set").prop("disabled",!1),e.post(nppp_admin_data.ajaxurl,{action:"nppp_update_cache_schedule_option",cache_schedule:s,_wpnonce:nppp_admin_data.cache_schedule_nonce},(function(n){if(n.success){var t=document.createElement("div");if(t.textContent="✔",t.style.position="absolute",t.style.left=o+"px",t.style.top=a+"px",t.style.backgroundColor="#50C878",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),1e3),"Option updated successfully. Unschedule success."===n.data){e(".scheduled-events-list").empty();'<h3 class="nppp-active-cron-heading">Cron Status</h3>','<div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div>',"</div>",e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div></div>')}}else e("#nginx_cache_schedule").prop("checked",!e("#nginx_cache_schedule").prop("checked")),alert("Error updating option!")}),"json")})),e(document).on("click",".nppp-cancel-btn",(function(){event.preventDefault();var n=e(this).data("hook");confirm('Are you sure you want to cancel the scheduled event "'+n+'"?')&&e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_cancel_scheduled_event",hook:n,_wpnonce:nppp_admin_data.cancel_scheduled_event_nonce},success:function(n){e(".scheduled-events-list").empty();e(".scheduled-events-list").append('<div class="nppp-scheduled-event"><h3 class="nppp-active-cron-heading">Cron Status</h3><div class="nppp-scheduled-event" style="padding-right: 45px;">No active scheduled events found!</div></div>'),console.log(n)},error:function(e,n,t){console.error(e.responseText),alert("An error occurred while canceling the scheduled event.")}})})),e("#clear-logs-button").on("click",(function(n){n.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_clear_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(n){e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_get_nginx_cache_logs",_wpnonce:nppp_admin_data.clear_logs_nonce},success:function(n){var t=n.data,o='<div class="logs-container"><div class="success-line"><span class="timestamp">'+t.substring(1,20)+"</span> "+t.substring(23)+'</div><div class="cursor blink">#</div></div>';e(".logs-container").html(o)},error:function(e,n,t){console.error("Error getting log content:",n,t)}})},error:function(e,n,t){console.error("AJAX request failed:",n,t)}})})),e("#api-key-button").on("click",(function(n){n.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_api_key_option",_wpnonce:nppp_admin_data.api_key_nonce},success:function(n){n.success?e("#nginx_cache_api_key").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)}})})),e("#nginx-regex-reset-defaults").on("click",(function(n){n.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_default_reject_regex_option",_wpnonce:nppp_admin_data.reject_regex_nonce},success:function(n){n.success?e("#nginx_cache_reject_regex").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)}})})),e("#nginx-extension-reset-defaults").on("click",(function(n){n.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_default_reject_extension_option",_wpnonce:nppp_admin_data.reject_extension_nonce},success:function(n){n.success?e("#nginx_cache_reject_extension").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)}})})),e("#nginx-key-regex-reset-defaults").on("click",(function(n){n.preventDefault(),e.ajax({url:nppp_admin_data.ajaxurl,method:"POST",data:{action:"nppp_update_default_cache_key_regex_option",_wpnonce:nppp_admin_data.cache_key_regex_nonce},success:function(n){n.success?e("#nginx_cache_key_custom_regex").val(n.data):console.error(n.data)},error:function(e,n,t){console.error(t)}})})),e(document).off("click","#nppp-clear-plugin-cache-btn").on("click","#nppp-clear-plugin-cache-btn",(function(n){n.preventDefault();var t=e("#nppp-clear-plugin-cache-btn"),o=t.offset(),a=t.outerWidth(),s=document.createElement("div");s.className="nppp-loading-spinner",s.style.position="absolute",s.style.left=o.left+a+10+"px",s.style.top=o.top-12+"px",s.style.zIndex="9999",document.body.appendChild(s),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_clear_plugin_cache",_wpnonce:nppp_admin_data.plugin_cache_nonce},success:function(e){document.body.removeChild(s);var n=o.left+a+10,t=o.top-3,p=document.createElement("div");p.style.position="absolute",p.style.left=n+"px",p.style.top=t+"px",p.style.color="#fff",p.style.padding="8px 12px",p.style.transition="opacity 0.3s ease-in-out",p.style.opacity="1",p.style.zIndex="9999",p.style.fontSize="13px",p.style.fontWeight="700",p.style.borderRadius="4px",e.success?(p.textContent="Cache Cleared",p.style.backgroundColor="#50C878"):(p.textContent="Cache cannot be cleared",p.style.backgroundColor="#D32F2F"),document.body.appendChild(p),setTimeout((function(){p.style.opacity="0",setTimeout((function(){document.body.removeChild(p),e.success&&location.reload()}),300)}),1700)},error:function(e,n,t){document.body.removeChild(s);var p=o.left+a+10,c=o.top-3,i=document.createElement("div");i.textContent="An ajax error occured",i.style.position="absolute",i.style.left=p+"px",i.style.top=c+"px",i.style.backgroundColor="#D32F2F",i.style.color="#fff",i.style.padding="8px 12px",i.style.transition="opacity 0.3s ease-in-out",i.style.opacity="1",i.style.zIndex="9999",i.style.fontSize="13px",i.style.fontWeight="700",i.style.borderRadius="4px",document.body.appendChild(i),setTimeout((function(){i.style.opacity="0",setTimeout((function(){document.body.removeChild(i)}),300)}),2e3)}})})),e(document).off("click","#nppp-restart-systemd-service-btn").on("click","#nppp-restart-systemd-service-btn",(function(n){n.preventDefault();var t=e("#nppp-restart-systemd-service-btn"),o=t.offset(),a=t.outerWidth(),s=document.createElement("div");s.className="nppp-loading-spinner",s.style.position="absolute",s.style.left=o.left+a+10+"px",s.style.top=o.top-12+"px",s.style.zIndex="9999",document.body.appendChild(s),e.ajax({url:nppp_admin_data.ajaxurl,type:"POST",data:{action:"nppp_restart_systemd_service",_wpnonce:nppp_admin_data.systemd_service_nonce},success:function(e){document.body.removeChild(s);var n=o.left+a+10,t=o.top-3,p=document.createElement("div");p.style.position="absolute",p.style.left=n+"px",p.style.top=t+"px",p.style.color="#fff",p.style.padding="8px 12px",p.style.transition="opacity 0.3s ease-in-out",p.style.opacity="1",p.style.zIndex="9999",p.style.fontSize="13px",p.style.fontWeight="700",p.style.borderRadius="4px",e.success?(p.textContent="Service Restarted",p.style.backgroundColor="#50C878"):(p.textContent="Service cannot be restarted",p.style.backgroundColor="#D32F2F"),document.body.appendChild(p),setTimeout((function(){p.style.opacity="0",setTimeout((function(){document.body.removeChild(p),e.success&&location.reload()}),300)}),1700)},error:function(){document.body.removeChild(s);var e=o.left+a+10,n=o.top-3,t=document.createElement("div");t.textContent="An ajax error occured",t.style.position="absolute",t.style.left=e+"px",t.style.top=n+"px",t.style.backgroundColor="#D32F2F",t.style.color="#fff",t.style.padding="8px 12px",t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1",t.style.zIndex="9999",t.style.fontSize="13px",t.style.fontWeight="700",t.style.borderRadius="4px",document.body.appendChild(t),setTimeout((function(){t.style.opacity="0",setTimeout((function(){document.body.removeChild(t)}),300)}),2e3)}})})),e("#nginx_cache_send_mail").prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff")),e("#nginx_cache_send_mail").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch").css("background","#66b317"),e(".nppp-on").css("color","#ffffff"),e(".nppp-off").css("color","#000000")):(e(".nppp-onoffswitch-switch").css("background","#ea1919"),e(".nppp-on").css("color","#000000"),e(".nppp-off").css("color","#ffffff"))})),e("#nginx_cache_auto_preload").prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff")),e("#nginx_cache_auto_preload").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-preload").css("background","#66b317"),e(".nppp-on-preload").css("color","#ffffff"),e(".nppp-off-preload").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload").css("background","#ea1919"),e(".nppp-on-preload").css("color","#000000"),e(".nppp-off-preload").css("color","#ffffff"))})),e("#nginx_cache_auto_preload_mobile").prop("checked")?(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#66b317"),e(".nppp-on-preload-mobile").css("color","#ffffff"),e(".nppp-off-preload-mobile").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#ea1919"),e(".nppp-on-preload-mobile").css("color","#000000"),e(".nppp-off-preload-mobile").css("color","#ffffff")),e("#nginx_cache_auto_preload_mobile").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#66b317"),e(".nppp-on-preload-mobile").css("color","#ffffff"),e(".nppp-off-preload-mobile").css("color","#000000")):(e(".nppp-onoffswitch-switch-preload-mobile").css("background","#ea1919"),e(".nppp-on-preload-mobile").css("color","#000000"),e(".nppp-off-preload-mobile").css("color","#ffffff"))})),e("#nginx_cache_preload_enable_proxy").prop("checked")?(e(".nppp-onoffswitch-switch-proxy").css("background","#66b317"),e(".nppp-on-proxy").css("color","#ffffff"),e(".nppp-off-proxy").css("color","#000000")):(e(".nppp-onoffswitch-switch-proxy").css("background","#ea1919"),e(".nppp-on-proxy").css("color","#000000"),e(".nppp-off-proxy").css("color","#ffffff")),e("#nginx_cache_preload_enable_proxy").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-proxy").css("background","#66b317"),e(".nppp-on-proxy").css("color","#ffffff"),e(".nppp-off-proxy").css("color","#000000")):(e(".nppp-onoffswitch-switch-proxy").css("background","#ea1919"),e(".nppp-on-proxy").css("color","#000000"),e(".nppp-off-proxy").css("color","#ffffff"))})),e("#nginx_cache_api").prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff")),e("#nginx_cache_api").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-api").css("background","#66b317"),e(".nppp-on-api").css("color","#ffffff"),e(".nppp-off-api").css("color","#000000")):(e(".nppp-onoffswitch-switch-api").css("background","#ea1919"),e(".nppp-on-api").css("color","#000000"),e(".nppp-off-api").css("color","#ffffff"))})),e("#nginx_cache_schedule").prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff")),e("#nginx_cache_schedule").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-schedule").css("background","#66b317"),e(".nppp-on-schedule").css("color","#ffffff"),e(".nppp-off-schedule").css("color","#000000")):(e(".nppp-onoffswitch-switch-schedule").css("background","#ea1919"),e(".nppp-on-schedule").css("color","#000000"),e(".nppp-off-schedule").css("color","#ffffff"))})),e("#nginx_cache_purge_on_update").prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff")),e("#nginx_cache_purge_on_update").change((function(){e(this).prop("checked")?(e(".nppp-onoffswitch-switch-autopurge").css("background","#66b317"),e(".nppp-on-autopurge").css("color","#ffffff"),e(".nppp-off-autopurge").css("color","#000000")):(e(".nppp-onoffswitch-switch-autopurge").css("background","#ea1919"),e(".nppp-on-autopurge").css("color","#000000"),e(".nppp-off-autopurge").css("color","#ffffff"))})),jQuery("#nppp-unique-id").click((function(e){var n=jQuery(this),t=n.find("span"),o=t.offset(),a=o.left+t.outerWidth()+10,s=o.top,p=n.data("unique-id"),c=document.createElement("input");c.value=p,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c);var i=document.createElement("div");i.textContent="Copied to clipboard",i.style.position="absolute",i.style.left=a+"px",i.style.top=s+"px",i.style.backgroundColor="#50C878",i.style.color="#fff",i.style.padding="2px 5px",i.style.transition="opacity 0.3s ease-in-out",i.style.opacity="1",i.style.zIndex="9999",i.style.fontSize="12px",i.style.fontWeight="700",document.body.appendChild(i),setTimeout((function(){i.style.opacity="0",setTimeout((function(){document.body.removeChild(i)}),300)}),3e3)})),jQuery("#nppp-api-key").click((function(n){var t=jQuery(this).find("span"),o=t.offset(),a=o.left+t.outerWidth()+10,s=o.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_update_api_key_copy_value",_wpnonce:nppp_admin_data.api_key_copy_nonce},success:function(e){var n=e.data.api_key,t=document.createElement("input");t.value=n,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);var o=document.createElement("div");o.textContent="Copied to clipboard",o.style.position="absolute",o.style.left=a+"px",o.style.top=s+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="2px 5px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="12px",o.style.fontWeight="700",document.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){document.body.removeChild(o)}),300)}),3e3)},error:function(e,n,t){console.error("Error fetching API key:",t)}})})),jQuery("#nppp-purge-url").click((function(n){var t=jQuery(this).find("span"),o=t.offset(),a=o.left+t.outerWidth()+10,s=o.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_rest_api_purge_url_copy",_wpnonce:nppp_admin_data.api_purge_url_copy_nonce},success:function(e){var n=e.data,t=document.createElement("input");t.value=n,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);var o=document.createElement("div");o.textContent="Copied to clipboard",o.style.position="absolute",o.style.left=a+"px",o.style.top=s+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="2px 5px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="12px",o.style.fontWeight="700",document.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){document.body.removeChild(o)}),300)}),3e3)},error:function(e,n,t){console.error("Error fetching API key:",t)}})})),jQuery("#nppp-preload-url").click((function(n){var t=jQuery(this).find("span"),o=t.offset(),a=o.left+t.outerWidth()+10,s=o.top;e.ajax({url:nppp_admin_data.ajaxurl,type:"GET",data:{action:"nppp_rest_api_preload_url_copy",_wpnonce:nppp_admin_data.api_preload_url_copy_nonce},success:function(e){var n=e.data,t=document.createElement("input");t.value=n,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);var o=document.createElement("div");o.textContent="Copied to clipboard",o.style.position="absolute",o.style.left=a+"px",o.style.top=s+"px",o.style.backgroundColor="#50C878",o.style.color="#fff",o.style.padding="2px 5px",o.style.transition="opacity 0.3s ease-in-out",o.style.opacity="1",o.style.zIndex="9999",o.style.fontSize="12px",o.style.fontWeight="700",document.body.appendChild(o),setTimeout((function(){o.style.opacity="0",setTimeout((function(){document.body.removeChild(o)}),300)}),3e3)},error:function(e,n,t){console.error("Error fetching API key:",t)}})})),e("#nppp-accordion").accordion({collapsible:!0,heightStyle:"content"}),e('.nppp-cron-event-select option[value=""][disabled]').hide(),e("#nppp_cron_event").on("click",(function(){e('.nppp-cron-event-select option[value=""][disabled]').hide()})),e("#nppp-purge-button, #nppp-preload-button").on("click",(function(n){n.preventDefault(),e(this).prop("disabled",!0).addClass("disabled"),e("#nppp-loader-overlay").addClass("active").fadeIn(200);var t=e(this).attr("href");setTimeout((function(){window.location.href=t}),500)}));var x=e("#nginx_cache_api_key"),b=e("#api-key-button");function v(e){return e.length<=10?"*".repeat(e.length):"*".repeat(10)+e.slice(10)}function C(e){x.data("original-key",e),x.val(v(e))}C(x.val()),x.on("focus",(function(){var e=x.data("original-key");x.val(e)})),x.on("blur",(function(){var e=x.data("original-key");x.val(v(e))})),x.on("input",(function(){var e=x.val();x.data("original-key",e)})),b.on("click",(function(){setTimeout((function(){C(x.val()),S["#nginx_cache_api_key"]=x.data("original-key")}),700)}));var k=x.closest("form");k.length&&k.on("submit",(function(e){var n=x.data("original-key");x.val(n)})),e(".nppp-submenu a").on("click",(function(n){n.preventDefault();var t=e(this).attr("href");e(t).length&&e("html, body").animate({scrollTop:e(t).offset().top-30},500)}));var w=e('#nppp-settings-form input[type="submit"]'),E=w.val(),S={},T=["#nginx_cache_path","#nginx_cache_cpu_limit","#nginx_cache_reject_regex","#nginx_cache_reject_extension","#nginx_cache_limit_rate","#nginx_cache_wait_request","#nginx_cache_email","#nginx_cache_tracking_opt_in","#nginx_cache_api_key","#nginx_cache_key_custom_regex"];function L(){var n=!1;T.forEach((function(t){var o=e(t),a=S[t];("#nginx_cache_api_key"===t?x.data("original-key"):"checkbox"===o.attr("type")?o.is(":checked"):o.val())!==a&&(n=!0)})),n?w.hasClass("nppp-submit-changed")||(w.addClass("nppp-submit-changed"),w.val("Save Settings Now")):j()}function j(){w.hasClass("nppp-submit-changed")&&(w.removeClass("nppp-submit-changed"),w.val(E))}T.forEach((function(n){var t=e(n);"#nginx_cache_api_key"===n?S[n]=x.data("original-key"):"checkbox"===t.attr("type")?S[n]=t.is(":checked"):S[n]=t.val()})),e(T.join(", ")).on("input change",(function(){L()})),e("#nppp-settings-form").on("submit",(function(){j(),T.forEach((function(n){var t=e(n);"checkbox"===t.attr("type")?S[n]=t.is(":checked"):S[n]=t.val()}))})),e("#nppp-settings-form").on("reset",(function(){setTimeout((function(){j(),T.forEach((function(n){var t=e(n);"checkbox"===t.attr("type")?S[n]=t.is(":checked"):S[n]=t.val()}))}),0)}))})),
document.addEventListener("DOMContentLoaded",(function(){new tempusDominus.TempusDominus(document.getElementById("nppp_datetimepicker1Input"),{display:{viewMode:"clock",components:{date:!1,month:!1,year:!1,decades:!1,hours:!0,minutes:!0,seconds:!1},icons:{time:"dashicons dashicons-arrow-up-alt2",up:"dashicons dashicons-arrow-up-alt2",down:"dashicons dashicons-arrow-down-alt2"},inline:!1,theme:"auto"},localization:{dateFormats:{LT:"HH:mm"},hourCycle:"h23",format:"LT"},stepping:5})})),document.addEventListener("DOMContentLoaded",(function(){["#nginx_cache_path","#nginx_cache_email","#nginx_cache_reject_regex","#nginx_cache_api_key","#nginx_cache_reject_extension","#nginx_cache_key_custom_regex"].forEach((function(e){const n=document.querySelector(e);if(n){function t(){n.value=n.value.trim()}function o(){let e;do{e=n.value,n.value=n.value.replace(/[^a-zA-Z0-9\/\-_\.]/g,""),n.value=n.value.replace(/\/{2,}/g,"/"),n.value=n.value.replace(/\/(?:[_\-]+)(\/|$)/g,"/"),n.value=n.value.replace(/\/+$/,"")}while(e!==n.value)}"#nginx_cache_path"===e&&n.addEventListener("blur",o),n.addEventListener("blur",t),n.addEventListener("input",(function(){setTimeout(t,0)}));const a=n.closest("form");a&&a.addEventListener("submit",(function(){t(),"#nginx_cache_path"===e&&o()}))}}))})),document.addEventListener("DOMContentLoaded",(function(){var e=function(e){var n=window.location.href,t=n.split("?");if(t.length>=2){for(var o=t[0],a=t[1].split("&"),s=[],p=0;p<a.length;p++){var c=a[p].split("=");-1===e.indexOf(c[0])&&s.push(a[p])}return o+"?"+s.join("&")}return n}(["status_message","message_type"]);history.replaceState(null,document.title,e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("nppp-settings-form");e&&e.addEventListener("submit",(function(){var e=document.getElementById("nppp-loader-overlay");e&&e.classList.add("active")}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("nppp-nginx-tabs"),n=document.querySelector("#nppp-settings-form .submit");function t(){if(!e||!n)return;const t=e.getBoundingClientRect();n.style.left=`${t.left}px`,n.style.width=`${t.width}px`,n.style.margin="0",n.style.padding="0"}const o=setInterval((()=>{const e=document.getElementById("nppp-nginx-tabs"),n=document.querySelector("#nppp-settings-form .submit");e&&n&&(clearInterval(o),t())}),10);window.addEventListener("resize",t)}));let s=null;document.querySelector(".nppp-submenu ul").addEventListener("click",(function(e){const n=e.target.closest("a");n&&(s&&s.classList.remove("active"),n.classList.add("active"),s=n)}))}(jQuery);
